(window.webpackJsonp=window.webpackJsonp||[]).push([["ConnectInboxModal"],{"/IVS":function(e,t,s){"use strict";s.d(t,"d",(function(){return n}));s.d(t,"b",(function(){return a}));s.d(t,"e",(function(){return i}));s.d(t,"c",(function(){return o}));s.d(t,"f",(function(){return r}));s.d(t,"g",(function(){return c}));s.d(t,"h",(function(){return l}));s.d(t,"j",(function(){return d}));s.d(t,"a",(function(){return u}));s.d(t,"i",(function(){return p}));const n="GOOGLE_FREE",a="GOOGLE_APPS",i="GOOGLE_FREE_API",o="GOOGLE_APPS_API",r="HUBSPOT_HOSTED",c="OUTLOOK",l="OUTLOOK365",d="UNKNOWN_IMAP",u="EXCHANGE",p="UNKNOWN"},"81Oe":function(e,t,s){"use strict";(function(e){var n=s("zUz2"),a=s.n(n);s.d(t,"a",(function(){return a.a}));e&&e.exports&&(e.exports.default=e.exports)}).call(this,s("sWDv")(e))},"9NgN":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n="PERMISSIONS_ERROR"},HsGp:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n),i=s("xV13"),o=s("uivf"),r=s("QgEn");const c=e=>Object(r.jsx)(o.a,Object.assign({},e,{langKey:"gmail"}));c.propTypes=Object.assign({},i.a,{allowRequestGroup:a.a.string.isRequired});t.a=c},LDwU:function(e,t,s){"use strict";s.d(t,"c",(function(){return a}));s.d(t,"a",(function(){return i}));s.d(t,"g",(function(){return o}));s.d(t,"j",(function(){return r}));s.d(t,"h",(function(){return c}));s.d(t,"i",(function(){return l}));s.d(t,"m",(function(){return d}));s.d(t,"o",(function(){return h}));s.d(t,"p",(function(){return m}));s.d(t,"n",(function(){return E}));s.d(t,"b",(function(){return S}));s.d(t,"l",(function(){return I}));s.d(t,"d",(function(){return w}));s.d(t,"f",(function(){return A}));s.d(t,"e",(function(){return T}));s.d(t,"q",(function(){return k}));s.d(t,"r",(function(){return M}));s.d(t,"s",(function(){return q}));s.d(t,"k",(function(){return Y}));var n=s("ozvU");const a="CONNECTIONS_RATE_LIMITED",i="APP_PASSWORD_REQUIRED",o="IMAP_AUTHENTICATION_ERROR",r="IMAP_VALIDATE_ERROR",c="IMAP_SETTINGS_INCORRECT",l="IMAP_UNKNOWN_IO_ERROR",d="SMTP_SETTINGS_INCORRECT",u="SMTP_MESSAGING",p="OFFICE_SEND_FAILED",h="UNAUTHORIZED",m="UNTRUSTED_CERTIFICATES",b="MISSING_INBOX_FOLDER",g="MISSING_DRAFTS_FOLDER",x="GMAIL_IMAP_DISABLED",j="OFFICE_ERROR",O="OFFICE_ERROR_ORGANIZATION_ACCESS_BLOCKED",C="OFFICE_ERROR_REST_API_NOT_ENABLED_FOR_COMPONENT_SHARED_MAILBOX",f="OFFICE_ERROR_INVALID_LICENSE",E="TRANSIENT",v="INBOX_VALIDATE_ERROR",S="AUTODISCOVERY_FAILURE",I="SHARED_INBOX_INVALID_DOWNGRADE",y="CONVERSATIONS_CREATE_CONFLICT",w="EXCHANGE_URL_INVALID",A="EXCHANGE_VERSION_INVALID",T="EXCHANGE_VALIDATE_ERROR",k="USER_DECLINED",_="InboxConnectUtils.wizard.failure.errorResponse",R="https://knowledge.hubspot.com/articles/kcs_article/email-notifications/how-can-i-resolve-an-unavailable-or-unauthorized-inbox-connection-error?hs_preview=hrvZeOCN-5437059821",N="https://knowledge.hubspot.com/articles/kcs_article/email-notifications/how-can-i-resolve-an-unavailable-or-unauthorized-inbox-connection-error#unavailable-imap-disabled-in-gmail",P="https://knowledge.hubspot.com/getting-started-with-the-hubspot-crm-free/how-to-disconnect-an-authorized-account-from-the-crm",U=e=>`${_}.${e}`,D=(e,t={})=>({description:U(e),options:t}),F=e=>{if(!Object(n.a)(e))return null;const t=/^Could not create inbox: (.*?) is a shared inbox across this portal/,s=e.match(t);return s?{emailAddress:s[1]}:null},M=e=>{if(!Object(n.a)(e))return null;const t=/^Could not create inbox: Users \[(.*?)\] must remove inbox with email (.*?) before continuing/,s=e.match(t);if(s){const e=s[1],t=s[2];return{usersEmails:Object(n.a)(e)&&e.split(", "),usersEmailsCSV:e,emailAddress:t}}return null},L=e=>{if(!Object(n.a)(e))return null;const t=/.*\[.*connected-email-inbox-access.*\]/;return!!e.match(t)},q=e=>{const t=F(e);if(t)return D("sharedInbox.alreadyConnected",t);const s=M(e);if(s){const{emailAddress:e,usersEmailsCSV:t}=s;return D("sharedInbox.alreadyConnectedAsPersonal",{emailAddress:e,usersEmailsCSV:t,link:P})}return L(e)?D("noInboxAccess"):null},B=D("reconnect"),H=D("updateYourInbox",{link:R}),V=D("reachOutToOfficeAdmin"),$=D("invalidLicense"),z=D("enableImap",{link:N}),G=D("testEmailFailed"),K=D("sharedInbox.invalidDowngrade"),W=D("sharedInbox.conversationsConflict"),Y={[h]:B,[v]:B,[b]:H,[g]:H,[j]:B,[O]:V,[C]:H,[f]:$,[E]:B,[x]:z,[u]:G,[p]:G,[I]:K,[y]:W,error:B}},RmcN:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var n=s("r1tY"),a=s.n(n),i=s("DFoL"),o=s("K8eT"),r=s("MvPw"),c=s("QgEn");function l(e,t,s,n){const i=document.createElement("div");return new Promise((o,l)=>{const d=Object(c.jsx)(r.a,{"data-layer-for":"Promptable",rootNode:t,children:Object(c.jsx)(e,Object.assign({},s,{onConfirm:o,onReject:l}))});n?a.a.unstable_renderSubtreeIntoContainer(n,d,i):a.a.render(d,i)}).finally(()=>{a.a.unmountComponentAtNode(i)})}function d(e,t=Object(o.a)()){i.a.warn({message:"Promptable: The `Promptable` function is deprecated. Try mounting `UIModal` directly.",url:"https://git.hubteam.com/HubSpot/UIComponents/issues/7435",key:"promptable-deprecation"});return(...s)=>l(e,t,...s)}},SQ8K:function(e,t,s){"use strict";s.r(t);(function(e){s.d(t,"GMAIL_LOGO_NAME",(function(){return o}));s.d(t,"OUTLOOK_LOGO_NAME",(function(){return r}));s.d(t,"EXCHANGE_LOGO_NAME",(function(){return c}));s.d(t,"gmail",(function(){return l}));s.d(t,"google_apps",(function(){return d}));s.d(t,"outlook",(function(){return u}));s.d(t,"outlook365",(function(){return p}));s.d(t,"exchange",(function(){return h}));s.d(t,"outlook_com",(function(){return m}));s.d(t,"imap",(function(){return b}));s.d(t,"hubspotHosted",(function(){return g}));s.d(t,"other",(function(){return x}));var n=s("G2Xo"),a=s("/IVS");const i=e=>()=>Object(n.a)("InboxConnectUtils.providers.name."+e),o="google-gmail",r="outlook",c="exchange",l={key:"gmail",name:"Gmail",getTranslatedName:i(a.d),logo:o,serviceType:"google",iconName:"google"},d={key:"gmail",name:"G Suite",getTranslatedName:i(a.b),logo:o,serviceType:"google",iconName:"google"},u={key:"outlook",name:"Outlook",getTranslatedName:i(a.g),logo:r,download:"https://app.getsidekick.com/outlook/download"},p={key:"outlook365",name:"Outlook 365",getTranslatedName:i(a.h),logo:r,serviceType:"office365",iconName:"office-365"},h={key:"exchange",name:"Exchange",getTranslatedName:i(a.a),logo:c,serviceType:"exchange"},m={key:"outlook_com",name:"Outlook.com",getTranslatedName:i(a.g),logo:r},b={key:"imap",name:"IMAP+SMTP",getTranslatedName:i(a.j)},g={key:"hubspotHosted",name:"Hosted Email",getTranslatedName:i(a.f)},x={key:"other",name:"other",getTranslatedName:i(a.i)};e&&e.exports&&(e.exports.default=e.exports)}).call(this,s("sWDv")(e))},iekK:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n),i=s("xV13"),o=s("uivf"),r=s("QgEn");const c=e=>Object(r.jsx)(o.a,Object.assign({},e,{langKey:"imap"}));c.propTypes=Object.assign({},i.a,{allowRequestGroup:a.a.string.isRequired});t.a=c},nAFJ:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));s.d(t,"b",(function(){return c}));var n=s("RmcN"),a=s("HsGp"),i=s("iekK"),o=s("y1B9");const r=Object(n.a)(a.a),c=(Object(n.a)(i.a),Object(n.a)(o.a));e&&e.exports&&(e.exports.default=e.exports)}).call(this,s("sWDv")(e))},oeX3:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n),i=s("9f1P"),o=s.n(i),r=s("+KD7"),c=s("6gy2");const l=e=>"top"===e||"bottom"===e,d=o.a.div.withConfig({displayName:"UIOverhang",componentId:"sc-1dy6jx9-0"})(["background-image:",";background-size:",";height:",";width:",";opacity:",";pointer-events:none;position:absolute;top:",";bottom:",";left:",";right:",";"],({gradientColor:e,side:t})=>`linear-gradient(to ${t}, ${Object(c.a)(e,0)}, ${e})`,({side:e,size:t})=>l(e)?`100% ${t}px}`:t+"px 100%",({side:e,size:t})=>l(e)&&t+"px",({side:e,size:t})=>!l(e)&&t+"px",({opacity:e})=>e,({side:e})=>"bottom"!==e&&0,({side:e})=>"top"!==e&&0,({side:e})=>"right"!==e&&0,({side:e})=>"left"!==e&&0);d.propTypes={gradientColor:a.a.string.isRequired,opacity:a.a.number.isRequired,side:a.a.oneOf(["top","bottom","left","right"]).isRequired,size:a.a.number.isRequired};d.defaultProps={gradientColor:r.KOALA,opacity:1,size:14};t.a=d},ozvU:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=e=>!!e&&"string"==typeof e},sWDv:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]);Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}});Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}});Object.defineProperty(t,"exports",{enumerable:!0});t.webpackPolyfill=1}return t}},tHAq:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n),i=s("/BSp");let o,r;function c(){o||(o=[]);return o}function l(){r||(r=a.a.oneOf(c()));return Object(i.a)(r,"logoName")}var d=s("Pnne"),u=s("QgEn");const p=e=>Object(u.jsx)(d.a,Object.assign({},e));p.defaultProps=d.a.defaultProps;p.propTypes=Object.assign({},d.a.propTypes,{name:l().isRequired});p.displayName="UILogo";t.a=p},tkXr:function(e,t,s){"use strict";s.r(t);var n=s("Ktcs"),a=s("VfuR"),i=s.n(a),o=s("sl/w"),r=s("iJaT"),c=s("BiPx"),l=s("qS8i"),d=s("DqRu"),u=s("dKJf"),p=s("Tqy5"),h=s("hmaQ"),m=s("LqZr"),b=s("6A2w"),g=s("CE3l"),x=s("QvWB"),j=s("5zIw"),O=s("wd43"),C=s("F1z2"),f=s("OdQM"),E=s("QgEn");class v extends n.Component{constructor(e){super(e);this.handleConnectEmailDone=()=>{this.props.onClose()};this.renderModalBody=this.renderModalBody.bind(this);this.state={connectCalendar:!0}}renderFeatureList(){return Object(E.jsxs)(h.a,{childClassName:"m-y-2 text-left",children:[Object(E.jsxs)("span",{children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.features.send"})]}),Object(E.jsxs)("span",{children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.features.log"})]}),Object(E.jsxs)("span",{children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.features.automate"})]}),Object(E.jsxs)("span",{children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.features.schedule"})]})]})}renderModalBody(){const{onSelectConnectInbox:e}=this.props,{connectCalendar:t}=this.state;return Object(E.jsxs)(O.a,{align:"center",itemRight:Object(E.jsx)(m.a,{name:"successful-send",width:100}),spacing:"medium",children:[Object(E.jsx)(g.a,{children:Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.header"})}),Object(E.jsxs)("div",{className:"text-left",children:[Object(E.jsx)("div",{className:"m-y-8",children:Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.subheader"})}),this.renderFeatureList(),Object(E.jsx)(C.a,{}),Object(E.jsx)(p.a,{checked:t,description:Object(E.jsx)(u.a,{use:"help",children:Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.connectCalendar.subtitle"})}),onChange:({target:{checked:e}})=>{this.setState({connectCalendar:e})},children:Object(E.jsx)(j.a,{title:Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.connectCalendar.helpIcon"}),children:Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.connectCalendar.checkbox"})})}),Object(E.jsx)(d.a,{className:"m-top-6",onClick:()=>{e(t);this.context.trackUserInteraction("open task modal",t?"connect inbox (+ calendar)":"connect inbox (no calendar)")},use:"primary",children:Object(E.jsx)(o.a,{message:"setup-guide-components.accountConnect.connectButton"})})]})]})}render(){const{onClose:e}=this.props;return Object(E.jsxs)(r.a,{centered:!0,use:"conversational",width:700,children:[Object(E.jsx)(b.a,{children:Object(E.jsx)(c.a,{onClick:()=>{e();this.context.trackUserInteraction("close task modal","connect account modal")}})}),Object(E.jsx)(l.a,{children:this.renderModalBody()})]})}}v.contextType=f.a;v.propTypes={onClose:i.a.func.isRequired,onSelectConnectInbox:i.a.func.isRequired};var S=v,I=s("CV3B");const y=(e,t)=>(s,n={},...a)=>{const i=n.query||{},o=Object.assign({},n,{portalId:t,query:Object.assign({},i,{portalId:t})});return e(s,o,...a)},w=["get","put","post","del"];var A=(e,t)=>w.reduce((s,n)=>Object.assign({},s,{[n]:y(e[n],t)}),{}),T=s("G2Xo"),k=s("oxA8"),_=s("VQUG"),R=s("x1f2"),N=s("LTV0");const P="DETECT_PROVIDER_STEP",U="CHOOSE_PROVIDER_STEP",D="CONNECT_INBOX_STEP",F="IMAP_INBOX_STEP",M="EXCHANGE_INBOX_STEP",L="TEST_MESSAGE_STEP",q="FAILURE_STEP",B="FINISH_STEP",H="OPT_INTO_AUTOMATION_STEP",V="POST_SETUP_STEP",$="EMAIL_INPUT_STEP",z="CUSTOM_EMAIL_DETECT_STEP",G="EXIT_SUCCESS",K="START_CONNECT";var W={STANDARD:"STANDARD",SHARED:"SHARED"};const Y=e=>Object.keys(e).map(t=>e[t]),X=i.a.shape({getAppName:i.a.func,getTracker:i.a.func,getPortalId:i.a.func,getGates:i.a.func,enableConnectedAccount:i.a.func,createTestEmail:i.a.func,queryTestEmail:i.a.func,getProviderNameByDomain:i.a.func,getFacsimileInboxByEmail:i.a.func,discoverInboxSettings:i.a.func,createImapInbox:i.a.func,createExchangeInbox:i.a.func,track:i.a.func,removeAllConnectionsForEmail:i.a.func,getUserInfo:i.a.func,setEnableAutomation:i.a.func,getEnableAutomation:i.a.func});var J={connectError:i.a.oneOfType([i.a.string,i.a.object]),emailAddress:i.a.string,isAutodetectFlow:i.a.bool,isAllowCustomEmailInput:i.a.bool,inboxType:i.a.oneOf(Y(W)),portalId:i.a.oneOfType([i.a.string,i.a.number]).isRequired,restrictProvider:i.a.bool.isRequired,selectedClient:i.a.string,setConnectError:i.a.func.isRequired,setEmailAddress:i.a.func.isRequired,onWizardDone:i.a.func.isRequired,setSelectedClient:i.a.func.isRequired,setShownStep:i.a.func.isRequired,setConnectedAccount:i.a.func.isRequired,trackingClient:i.a.object.isRequired,allowedProviders:i.a.arrayOf(i.a.string),oauthOptions:i.a.object,service:X.isRequired,showExtensionInstall:i.a.bool.isRequired,inboxCreateContext:i.a.object,onStateChange:i.a.func,onCancel:i.a.func,selectedAutomation:i.a.bool,setSelectedAutomation:i.a.func.isRequired,whatToExpectDescription:i.a.node},Q=s("QYOI"),Z=s("SQ8K"),ee=s("/IVS");const te="InboxConnectUtils.wizard.imapInbox.errors",se=e=>`${te}.${e&&{500:!0,APP_PASSWORD_REQUIRED:!0,CONNECTIONS_RATE_LIMITED:!0,GENERIC_IMAP_DISABLED:!0,GENERIC_MISSING_FOLDER:!0,IMAP_AUTHENTICATION_ERROR:!0,IMAP_SETTINGS_INCORRECT:!0,IMAP_UNKNOWN_IO_ERROR:!0,IMAP_VALIDATE_ERROR:!0,SMTP_SETTINGS_INCORRECT:!0,UNAUTHORIZED:!0,UNTRUSTED_CERTIFICATES:!0,MISSING_INBOX_FOLDER:!0,MISSING_DRAFTS_FOLDER:!0,GMAIL_IMAP_DISABLED:!0,OFFICE_ERROR:!0,OFFICE_ERROR_ORGANIZATION_ACCESS_BLOCKED:!0,OFFICE_ERROR_REST_API_NOT_ENABLED_FOR_COMPONENT_SHARED_MAILBOX:!0,OFFICE_ERROR_INVALID_LICENSE:!0,TRANSIENT:!0,IMAP_DISABLED_OR_LOGIN_FAILURE:!0}[e]?e:"error"}`,ne=e=>e.reduceRight((e,t)=>e.set(t,se(t)),Object(Q.Map)()),ae=e=>{switch(e){case ee.a:return Z.exchange;case ee.d:case ee.e:return Z.gmail;case ee.b:case ee.c:return Z.google_apps;case ee.h:return Z.outlook365;case ee.f:return Z.hubspotHosted;case ee.i:return Z.other;default:return Z.imap}},ie=e=>e===ee.i?null:ae(e).key;class oe extends n.Component{componentDidMount(){this.props.trackingClient.trackStepView(P);const{service:e,setSelectedClient:t,setShownStep:s,emailAddress:n,setEmailAddress:a}=this.props;(""===n?()=>e.getProvider():()=>e.getProviderByEmailAddress(n))().then(e=>{const i=ie(e.get("name"));if(null===i)throw new Error("No client detectable.");""===n&&a(e.get("email"));t(i);s(H)}).catch(()=>{s(U)})}render(){const e="InboxConnectUtils.wizard.detectProvider";return Object(E.jsx)(_.a,{className:"text-center",align:"center",justify:"center","data-selenium":"detect-client-step",style:{height:519},children:Object(E.jsxs)(R.a,{basis:"650px",children:[Object(E.jsx)("h2",{children:Object(E.jsx)(k.a,{message:e+".title"})}),Object(E.jsxs)("div",{children:[Object(E.jsx)(N.a,{className:"display-inline-block"}),Object(E.jsx)("span",{className:"m-left-2 display-inline-block",style:{height:42,verticalAlign:"middle"},children:Object(T.a)(e+".detecting")})]})]})})}}oe.propTypes=J;var re=s("mLvQ"),ce=s("+KD7"),le=s("88tZ"),de=s("77dM"),ue=s("vuW9"),pe=s("tHAq"),he=s("nAFJ"),me=s("yYAF");const be=Object(me.getFullUrl)("app"),ge=e=>"/inbox-connect/"+e,xe=be+"/oauthor/v1/google/start",je=be+"/oauthor/v1/office365/start",Oe=(e,t="unknown")=>`${be}/settings/${e}/user-preferences/email?installwizardprovider=${t}`;var Ce=s("D2Y9"),fe=s("Dau1"),Ee=s("LdnN"),ve=s("EuUD"),Se=s("9mTs");var Ie=new RegExp(`^${Se.a.domain}$`,"i"),ye=Object(ve.a)({name:"Domain",validator:e=>Ie.test(e)});const we=(e=>{const t={};let s;if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=s);return t})({GENERIC:null,NOT_FOUND:null,READ_ONLY:null,UNAUTHORIZED:null});we.UNAUTHORIZED,we.UNAUTHORIZED,we.NOT_FOUND,we.NOT_FOUND,we.GENERIC,we.GENERIC,we.READ_ONLY,we.READ_ONLY;var Ae=s("LDwU"),Te=s("ozvU");const{GENERIC:ke,NOT_FOUND:_e,UNAUTHORIZED:Re}=we,Ne=e=>({email:e.get("APP_PASSWORD_REQUIRED")||e.get("UNAUTHORIZED"),password:e.get("UNAUTHORIZED"),imapHost:e.get("IMAP_AUTHENTICATION_ERROR")||e.get("IMAP_SETTINGS_INCORRECT")||e.get("IMAP_UNKNOWN_IO_ERROR")||e.get("IMAP_VALIDATE_ERROR")||e.get("GENERIC_IMAP_DISABLED"),imapPort:e.get("IMAP_AUTHENTICATION_ERROR")||e.get("IMAP_SETTINGS_INCORRECT")||e.get("IMAP_UNKNOWN_IO_ERROR")||e.get("IMAP_VALIDATE_ERROR")||e.get("GENERIC_IMAP_DISABLED"),smtpHost:e.get("SMTP_SETTINGS_INCORRECT"),smtpPort:e.get("SMTP_SETTINGS_INCORRECT"),acceptUntrustedCert:e.get("UNTRUSTED_CERTIFICATES")}),Pe=e=>Object(Ae.s)(e)||Ae.k[e]||null,Ue=e=>{const t=Pe(e)||Ae.k.error;return{key:t.description,options:t.options}},De=e=>!!e&&"number"==typeof e&&e>0,Fe=e=>"127.0.0.1"===e,Me=e=>De(e)||Object(Te.a)(e),Le=e=>e&&Ee.a.test(e),qe=e=>e&&ye.test(e)&&!Fe(e),Be=e=>!!e&&/^https:\/\/.+\.asmx$/.test(e),He=(e,t)=>{const s=Object(fe.parseUrl)(e);s.query=Object(Ce.stringify)(t);return Object(fe.buildUrl)(s)},Ve=/^https?:\/\//,$e=e=>{if("string"!=typeof e||Be(e))return null;e&&!Ve.test(e)&&qe(e)&&(e="https://"+e);const t=Object(fe.parseUrl)(e);return t&&t.hostname?`https://${t.hostname}/EWS/Exchange.asmx`:null};function ze(){let e=()=>{},t=()=>{};return{promise:new Promise((s,n)=>{e=s;t=n}),resolve:e,reject:t}}var Ge=ze,Ke={gmail:"google",outlook:"office365"};const We="crm.v2",Ye="gmail";let Xe;const Je=e=>t=>{const s=t.origin||t.originalEvent.origin||"";if(-1===s.indexOf("getsidekick")&&-1===s.indexOf("hubspot"))return;const n=t.data||{};if(-1!==(n.type||"").indexOf("INBOX_CONNECT")){!0===n.error?e.reject(n):e.resolve(n);window.removeEventListener("message",Xe);Xe=null}};class Qe{constructor(e,t,s){this.connectInboxUrl=e;this.serviceType=t;this.legalPrompt=s;"BroadcastChannel"in window&&(this.channel=new BroadcastChannel("inbox_connect_channel"));null===this.connectInboxUrl&&console.error('"connectInboxUrl" is a required property on the "ConnectInbox" class.');null===this.serviceType&&console.error('"serviceType" is a required property on the "ConnectInbox" class.')}connect(e,t="CRM_INBOX_CONNECT"){return this.connectWithOptions({requestGroup:t,portalId:e,checkPrivy:!1})}baseConnect(e,t,s,n=!1,a){t.location.href=this.getConnectInboxUrl(null,e,s,n,a);return this.waitForConnectCallback()}waitForConnectCallback(){const e=Ge();Xe=Je(e);window.addEventListener("message",Xe,!1);this.channel&&(this.channel.onmessage=e=>{Xe(e);this.channel.close()});return e.promise}getConnectInboxUrl(e,t,s,n=!1,a={}){const i=this.serviceType===Ke.gmail?{scopeNamespace:Ye}:{},o=Object.assign({origin:window.location.origin,serviceType:this.serviceType,isShared:n},a);if(s){i.portalId=s;o.portalId=s}e&&(o.next=e);const r=He(ge(s),o);i.appendToFinal=r;return He(`${this.connectInboxUrl}/${t||We}`,i)}connectWithOptions({requestGroup:e="CRM_INBOX_CONNECT",appNamespace:t,apiClient:s,portalId:n,isShared:a=!1,useActionRedirect:i=!1,reconnectEmail:o}){return new Promise((r,c)=>{this.maybeShowPrivyPermissions(!1,e,s).then(e=>{this.baseConnect(t,e,n,a,{useActionRedirect:i,reconnectEmail:o}).then(r,t=>{e.close&&e.close();c(t)})},c)})}maybeShowPrivyPermissions(e,t,s){return new Promise((e,n)=>{let a=null;const i={allowRequestGroup:t,apiClient:s,onClick:()=>{e(a=window.open())}},o=e=>{a&&a.close&&a.close();n(e)};this.legalPrompt(i).then(e,o)})}}var Ze=Qe;const et=he.a;class tt extends Ze{constructor(){super(xe,Ke.gmail,et)}}var st=new tt;const nt=he.b;class at extends Ze{constructor(){super(je,Ke.outlook,nt)}}var it=new at,ot=s("81Oe");const rt=()=>Object(E.jsx)("b",{children:Object(E.jsx)(k.a,{message:"InboxConnectUtils.wizard.connectInbox.whatToExpect"})});function ct({content:e}){return e?Object(E.jsx)("div",{children:e}):Object(E.jsx)(rt,{})}var lt=ct,dt=s("npjq"),ut=s("9f1P"),pt=s.n(ut),ht=s("t6nY"),mt=s.n(ht),bt=s("BF+R"),gt=s("1IE1"),xt=s("2TvS"),jt=s("CkSH"),Ot=s("Pw6n"),Ct=s("tUDx"),ft=s("cj42"),Et=s("TMtl"),vt=s("X/mn");let St=!1,It=!1,yt=!1;const wt=(e,t,s)=>{const n=document.createElement("div");n.setAttribute("aria-hidden","true");n.textContent=e;n.style.position="absolute";n.style.top="-999px";n.style.fontFamily=t;n.style.fontWeight=s;document.body.appendChild(n);return n},At=(e,t)=>{for(let s=0;s<e.length;s++){if(e[s].getBoundingClientRect().width!==t[s].getBoundingClientRect().width){document.body.removeChild(e[s]);document.body.removeChild(t[s]);e.splice(s,1);t.splice(s,1)}}},Tt=new Promise(e=>{Object(vt.a)(()=>{if(St){e();return}const t="BESbswy",s=`"${Et.i}", ${Et.d}`,n=[],a=[];[Et.q,Et.p,Et.m,Et.l].forEach(e=>{n.push(wt(t,s,e));a.push(wt(t,Et.d,e))});const i=()=>{At(n,a);if(0===n.length){It=!0;e()}else setTimeout(i,50)};i()})}),kt=()=>It;new Promise(e=>{Object(vt.a)(()=>{if(St){e();return}const t="add",s=`"${Et.g}", ${Et.d}`,n=[],a=[];["normal","bold"].forEach(e=>{n.push(wt(t,s,e));a.push(wt(t,Et.d,e))});const i=()=>{At(n,a);if(0===n.length){yt=!0;e()}else setTimeout(i,50)};i()})});var _t=s("TPCz"),Rt=s("oeX3"),Nt=s("02LW"),Pt=s("CAN/");const Ut=pt()(Rt.a).withConfig({displayName:"UIExpandableText__ExpandableTextOverhang",componentId:"sc-6in58g-0"})(["",";"],e=>e.scrollable&&"\n    /* Compensate for border on scroll container */\n    right: 1px;\n    bottom: 1px;\n    left: 1px;\n  ");Ut.propTypes=Object.assign({},Rt.a.propTypes,{scrollable:i.a.bool.isRequired});Ut.defaultProps=Rt.a.defaultProps;const Dt=e=>({maxHeight:e}),Ft=(e,t)=>null!=t?16*t:e;class Mt extends n.Component{constructor(e){super(e);this.delayedFitToMaxLines=()=>{Object(Pt.a)(this._timeout);this._timeout=Object(Pt.c)(this.fitToMaxLines)};this.getButtonHeight=e=>{if(!e)return 0;const t=window.getComputedStyle(e),s=parseFloat(t.marginTop)+parseFloat(t.marginBottom);return Math.ceil(e.offsetHeight+s)};this.fitToMaxLines=()=>{if(!this._el)return;const{maxHeight:e,maxHeightRems:t}=this.props,{collapsible:s,contentHeight:n}=this.state,a=this.getButtonHeight(this._containerEl.children[1]),i=this._el.scrollHeight+a;n!==i&&this.setState({contentHeight:i});const o=i>Ft(e,t);s!==o&&this.setState({collapsible:o})};this.handleExpandButtonClick=e=>{const{onExpandButtonClick:t,onExpandedChange:s}=this.props;Object(xt.a)(t,e);s(Object(Ot.a)(!0))};this.handleCollapseButtonClick=e=>{const{onCollapseButtonClick:t,onExpandedChange:s}=this.props;Object(xt.a)(t,e);const n=this._containerEl;n.style.maxHeight=n.scrollHeight+"px";s(Object(Ot.a)(!1))};this.handleTextWrapperFocus=e=>{const{expandOnFocus:t,onExpandedChange:s,toggleable:n}=this.props;if(t&&n){if(!Object(bt.a)()&&!/TEXTAREA|INPUT/.test(e.target.tagName))return;s(Object(Ot.a)(!0))}};this.handleTextWrapperTransitionEnd=e=>{const t=this._el;if(e.target===t&&"max-height"===e.propertyName){const{expanded:e,fullyExpanded:t}=this.state;e&&!t&&this.setState({fullyExpanded:!0})}};this.textWrapperRefCallback=e=>{this._el=e};this.textContainerRefCallback=e=>{this._containerEl=e};this.state={contentHeight:null,collapsible:!1,fullyExpanded:!1};this._getStyle=Object(Nt.a)(Dt)}componentDidMount(){this.delayedFitToMaxLines();this.startMutationObserver();addEventListener("resize",this.delayedFitToMaxLines);this._el&&this._el.addEventListener("load",this.delayedFitToMaxLines,!0);kt()||Tt.then(this.delayedFitToMaxLines)}componentDidUpdate(e,t){this.stopMutationObserver();t.contentHeight===this.state.contentHeight&&t.collapsible===this.state.collapsible&&this.delayedFitToMaxLines();t.collapsible!==this.state.collapsible&&Object(xt.a)(this.props.onCollapsibleChange,this.state.collapsible);this.startMutationObserver()}componentWillUnmount(){this.stopMutationObserver();Object(Pt.a)(this._timeout);removeEventListener("resize",this.delayedFitToMaxLines);this._el&&this._el.removeEventListener&&this._el.removeEventListener("load",this.delayedFitToMaxLines,!0)}startMutationObserver(){if(this._el){this._observer=new MutationObserver(this.delayedFitToMaxLines);this._observer.observe(this._el,{attributes:!0,childList:!0,subtree:!0})}}stopMutationObserver(){if(this._observer){this._observer.disconnect();this._observer=null}}render(){const{buttonAlign:e,children:t,className:s,collapseButtonText:n,expandButtonText:a,expanded:i,fadeOutHeight:o,fadeOutHeightRems:r,gradientColor:c,hideButtonCaret:l,maxHeight:u,maxHeightRems:p,onCollapseButtonClick:h,onExpandButtonClick:m,Overhang:b,scrollable:g,toggleable:j,use:O}=this.props,{collapsible:C,contentHeight:f,fullyExpanded:v}=this.state,S=j&&C,I=!g&&S,y=mt()(s,"private-expandable-text",g&&"private-expandable-text--scrollable",I&&"private-expandable-text__overhang-wrapper"),w="private-expandable-text__container"+(I?"":" private-expandable-text__overhang-wrapper"),A=mt()("private-expandable-text__toggle-button",g?"align-right":"left"===e&&"align-left"),T=i?f:Ft(u,p),k=S?Object(E.jsxs)(d.a,{"aria-hidden":i?!h:!m,className:A,onClick:i?this.handleCollapseButtonClick:this.handleExpandButtonClick,use:"link",children:[g||l?null:Object(E.jsx)(x.a,{color:ce.CALYPSO,name:i?"up":"down"}),Object(Ct.a)(i?n:a)]}):null,_="on-dark"===O?ce.GYPSUM:ce.OLAF;return Object(E.jsxs)("div",{className:w,"data-collapsible":C,ref:this.textContainerRefCallback,style:v?null:this._getStyle(T),children:[g&&k,Object(E.jsxs)("div",{className:y,onFocus:this.handleTextWrapperFocus,onTransitionEnd:this.handleTextWrapperTransitionEnd,ref:this.textWrapperRefCallback,children:[t,C&&!i?Object(E.jsx)(b,{gradientColor:null!=c?c:_,scrollable:g,side:"bottom",size:Ft(o,r)}):null]}),!g&&k]})}}Mt.propTypes={buttonAlign:i.a.oneOf(["left","center"]).isRequired,children:i.a.node.isRequired,collapseButtonText:Object(ft.a)(i.a.node).isRequired,expandButtonText:Object(ft.a)(i.a.node).isRequired,expanded:i.a.bool,expandOnFocus:i.a.bool.isRequired,fadeOutHeight:i.a.number.isRequired,fadeOutHeightRems:Object(_t.a)(i.a.number),gradientColor:i.a.string,hideButtonCaret:i.a.bool.isRequired,maxHeight:i.a.number.isRequired,maxHeightRems:Object(_t.a)(i.a.number),onCollapsibleChange:Object(_t.a)(i.a.func),onCollapseButtonClick:i.a.func,onExpandButtonClick:i.a.func,onExpandedChange:i.a.func,Overhang:Object(gt.a)(Ut),scrollable:i.a.bool,toggleable:i.a.bool,use:i.a.oneOf(["default","on-dark"])};Mt.defaultProps={buttonAlign:"center",collapseButtonText:()=>dt.a.text("salesUI.UIExpandableText.collapseButtonText"),expandButtonText:()=>dt.a.text("salesUI.UIExpandableText.expandButtonText"),expanded:!1,expandOnFocus:!0,fadeOutHeight:32,hideButtonCaret:!1,maxHeight:120,Overhang:Ut,scrollable:!1,toggleable:!0,use:"default"};Mt.displayName="UIExpandableText";var Lt=Object(jt.a)(Mt,["expanded"]);const qt="InboxConnectUtils.wizard.connectInbox.",Bt="default";function Ht({selectedClient:e=Bt}){const t=e===Z.gmail.key;return Object(E.jsx)(Lt,{className:"m-bottom-6",scrollable:!0,toggleable:!1,maxHeight:240,fadeOutHeight:80,children:Object(E.jsx)(k.a,{message:`${qt}${e}${t?".incrementalScoping":""}.legal`})})}var Vt=Ht;const $t="InboxConnectUtils.wizard",zt="InboxConnectUtils.wizard.connectInbox.",Gt="default",Kt={[Z.imap.key]:F,[Z.exchange.key]:M};class Wt extends n.Component{constructor(...e){super(...e);this.onClickChooseProviderLink=()=>{this.props.trackingClient.trackStepAction(D,"clicked connect different account link");this.props.setShownStep(U)}}componentDidMount(){const e=this.props.selectedClient||Gt;this.props.trackingClient.trackStepView(D,e)}handleConnectInboxClick(){const{inboxType:e,setShownStep:t,portalId:s,oauthOptions:n,inboxCreateContext:a,selectedAutomation:i,service:o}=this.props,r=this.props.selectedClient||Gt;this.props.trackingClient.trackStepAction(D,"Click connect(connect-inbox-step)");const{outlook365:c}=Z,l=e=>{const{error:t,payload:s}=e;if(t){const{message:e="",emailAddress:t=""}=s||{};this.props.setEmailAddress(t);this.props.setConnectError(e)}this.props.setShownStep(q)},d=Kt[r];if(d)t(d);else{const d=r===c.key?it:st,u=e===W.SHARED;if(n&&n.redirectUrl){const e=a||{};e.passthrough={selectedAutomation:i};const t=d.getConnectInboxUrl(n.redirectUrl,null,s,u,{useActionRedirect:!0,inboxCreateContext:JSON.stringify(e)});window.location.href=t;return}this.props.onStateChange&&this.props.onStateChange({cancelable:!1});const p=({payload:e})=>{this.props.setEmailAddress(e.emailAddress);this.props.setConnectedAccount(e)},h=window.open();d.baseConnect(void 0,h,s,u,{inboxCreateContext:a&&JSON.stringify(a)},o).then(p).then(()=>t(L)).catch(l).finally(()=>{h&&!h.closed&&h.close()}).catch(e=>{setTimeout(()=>{throw e})})}}renderConnectButton(){const{onCancel:e}=this.props;return e?Object(E.jsxs)("div",{className:"justify-center",children:[Object(E.jsx)(d.a,{className:"p-x-12",use:"primary",onClick:()=>this.handleConnectInboxClick(),children:Object(E.jsx)(k.a,{message:$t+".agree"})}),Object(E.jsx)(d.a,{className:"p-x-12",use:"secondary",onClick:()=>e(),"data-test-id":"wizard-cancel-button",children:Object(E.jsx)(k.a,{message:$t+".cancel"})})]}):Object(E.jsx)(d.a,{use:"primary",onClick:()=>this.handleConnectInboxClick(),children:Object(E.jsx)(k.a,{message:$t+".continue"})})}renderImage(){const e={gmail:Z.GMAIL_LOGO_NAME,outlook365:Z.OUTLOOK_LOGO_NAME,exchange:Z.EXCHANGE_LOGO_NAME},{setShownStep:t,restrictProvider:s}=this.props,n=this.props.selectedClient||Gt,a=Object(E.jsx)(de.a,{className:"display-block",onClick:()=>{t(U)},children:Object(E.jsx)(o.a,{message:`${zt}${n}.chooseLink`})}),i=!s&&Object(E.jsx)(ue.a,{title:Object(E.jsx)(re.a,{message:`${zt}${n}.providerDetected`,options:{chooseLink:a}}),children:Object(E.jsx)(x.a,{name:"info",size:"xxs",color:ce.BATTLESHIP,className:"m-x-1"})});return Object(E.jsxs)("div",{className:"m-y-4",children:[e[n]?Object(E.jsx)(pe.a,{name:e[n],style:{height:40}}):Object(E.jsx)(le.a,{className:"m-y-2",src:ot.a,responsive:!1,style:{height:40}}),Object(E.jsxs)("div",{children:[Object(E.jsx)("span",{children:Object(E.jsx)(o.a,{message:`${zt}${n}.label`})}),i]})]})}render(){const{restrictProvider:e,emailAddress:t,whatToExpectDescription:s,service:n}=this.props,a=this.props.selectedClient||Gt,i=Object(E.jsx)("div",{children:Object(E.jsx)(de.a,{onClick:this.onClickChooseProviderLink,children:Object(E.jsx)(o.a,{message:zt+"chooseOther"})})});return Object(E.jsx)(_.a,{className:"text-center",justify:"center","data-selenium":"connect-inbox-step",children:Object(E.jsxs)(R.a,{basis:"650px",children:[Object(E.jsx)("h2",{children:Object(E.jsx)(k.a,{message:`${zt}${a}.title`})}),this.renderImage(),Object(E.jsx)("b",{children:t}),!e&&i,Object(E.jsxs)("div",{className:"text-left m-top-4",children:[Object(E.jsx)(lt,{content:s}),Object(E.jsx)(Vt,{selectedClient:a,service:n})]}),this.renderConnectButton()]})})}}Wt.propTypes=J;const Yt="InboxConnectUtils.wizard.optIntoAutomation";class Xt extends n.Component{constructor(e){super(e);this.state={isChecked:!1}}componentDidMount(){this.props.trackingClient.trackStepView(H)}handleButtonClick(){const{setShownStep:e,isAllowCustomEmailInput:t,emailAddress:s}=this.props;this.props.setSelectedAutomation(this.state.isChecked);e(!s&&t?$:D)}renderFeatureList(){return Object(E.jsxs)(h.a,{lastChildClassName:"text-left",childClassName:"m-y-2 text-left",children:[Object(E.jsxs)("span",{children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsx)(k.a,{message:Yt+".bullet1"})]}),Object(E.jsxs)("span",{children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsx)(k.a,{message:Yt+".bullet2"})]}),Object(E.jsxs)("span",{className:"flex-row",children:[Object(E.jsx)(x.a,{className:"m-right-2",name:"success"}),Object(E.jsxs)("div",{children:[Object(E.jsx)(k.a,{message:Yt+".bullet3"}),Object(E.jsx)("p",{className:"m-bottom-0",children:Object(E.jsx)(u.a,{use:"help",children:Object(E.jsx)(k.a,{message:Yt+".microcopy"})})})]})]})]})}render(){return Object(E.jsx)(_.a,{className:"text-left","data-selenium":"opt-into-automation-step",style:{minHeight:325},children:Object(E.jsxs)(R.a,{basis:"650px",children:[Object(E.jsxs)(O.a,{align:"center",itemRight:Object(E.jsx)(m.a,{style:{marginRight:"50px"},name:"successful-send",width:110}),spacing:"medium",children:[Object(E.jsx)("h2",{className:"m-bottom-8",children:Object(E.jsx)(k.a,{message:Yt+".title"})}),this.renderFeatureList()]}),Object(E.jsx)(C.a,{}),Object(E.jsxs)(p.a,{checked:this.state.isChecked,onChange:({target:{checked:e}})=>{this.setState({isChecked:e})},children:[Object(E.jsx)(k.a,{message:Yt+".setting"}),Object(E.jsx)("p",{className:"m-top-1 m-bottom-0",children:Object(E.jsx)(u.a,{children:Object(E.jsx)(de.a,{external:!0,href:"https://knowledge.hubspot.com/email-tracking/connected-inbox-automation",children:Object(E.jsx)(k.a,{message:Yt+".learnMore"})})})})]}),Object(E.jsx)(d.a,{className:"m-top-6",use:"primary",onClick:()=>this.handleButtonClick(),children:Object(E.jsx)(k.a,{message:Yt+".button"})})]})})}}Xt.propTypes=J;var Jt=Xt,Qt=s("vLjm"),Zt=s("66eB");function es(e){if(e>=0&&e<=9)return e;throw new Error(`expected \`arity\` from 0 to 9 but got \`${e}\``)}function ts(e,t){if("function"==typeof e)return e;throw new Error(`expected \`${"number"==typeof t?`operation[${t}]`:"operation"}\` to be a function but got \`${String(e)}\``)}function ss(e,t){es(e);ts(t);switch(e){case 0:return function(){return t(...arguments)};case 1:return function(e){return t(...arguments)};case 2:return function(e,s){return t(...arguments)};case 3:return function(e,s,n){return t(...arguments)};case 4:return function(e,s,n,a){return t(...arguments)};case 5:return function(e,s,n,a,i){return t(...arguments)};case 6:return function(e,s,n,a,i,o){return t(...arguments)};case 7:return function(e,s,n,a,i,o,r){return t(...arguments)};case 8:return function(e,s,n,a,i,o,r,c){return t(...arguments)};case 9:return function(e,s,n,a,i,o,r,c,l){return t(...arguments)};default:return t}}function ns(e,t,s){const n=ss(t,as.bind(null,e,t,s));n.args=s;n.operation=e;return n}function as(e,t,s,...n){const a=t-n.length,i=s.concat(n);return a<=0?e(...i):ns(e,a,i)}function is(e,t){return ns(ts(t),es(e),[])}var os=is(2,is);function rs(e){return os(e.length,e)}function cs(e){if("number"==typeof e&&e>=0)return e;throw new Error(`expected \`interval\` to be a positive number but got \`${e}\``)}function ls(e,t){cs(e);ts(t);let s,n,a=null;function i(){clearTimeout(a);a=null}function o(){i();n=t(...s)}function r(...t){s=t;i();a=setTimeout(o,e);return n}r.cancel=i;return r}var ds=rs(ls),us=s("4eMT"),ps=s("6KwT"),hs=s("uzdC"),ms=s("V4AE");const bs=["Component","defaultValue","description","error","helpKeySuffix","hideLabel","keyPrefix","messageKeySuffix","name","onChange","placeholder","placeholderKeySuffix","placeholderOptions","required","validationMessage","value","wrapperProps"];class gs extends n.PureComponent{render(){const e=this.props,{Component:t,defaultValue:s,description:n,error:a,helpKeySuffix:i,hideLabel:o,keyPrefix:r,messageKeySuffix:c,name:l,onChange:d,placeholder:u,placeholderKeySuffix:h,placeholderOptions:m,required:b,validationMessage:g,value:x,wrapperProps:j}=e,O=Object(Qt.a)(e,bs),C=c?Object(T.a)(`${r}.${c}`):"",f=i?Object(T.a)(`${r}.${i}`):void 0,v=h?Object(T.a)(`${r}.${h}`,m):void 0,S={[o?"aria-label":"label"]:C,description:n?Object(T.a)(`${r}.${n}`):void 0,style:{display:"block"}},I={};t&&t.type===p.a.type||(I.error=a);return Object(E.jsx)(hs.a,Object.assign({},j,S,{error:a||!1,help:f,required:b,validationMessage:g,children:Object(E.jsx)(t,Object.assign({},O,I,{defaultValue:x?void 0:s,name:l,onChange:e=>d(e,l),placeholder:u||v,value:x||""}))}))}}gs.propTypes={Component:i.a.elementType.isRequired,description:i.a.string,error:i.a.bool,helpKeySuffix:i.a.string,hideLabel:i.a.bool,keyPrefix:i.a.string.isRequired,messageKeySuffix:i.a.string.isRequired,name:i.a.string.isRequired,onChange:i.a.func.isRequired,placeholder:i.a.node,placeholderKeySuffix:i.a.string,placeholderOptions:i.a.object,required:i.a.bool,validationMessage:i.a.node,value:i.a.oneOfType([i.a.number,i.a.string]),wrapperProps:i.a.object,defaultValue:i.a.oneOfType([i.a.number,i.a.string])};gs.defaultProps={Component:ms.a,hideLabel:!1};var xs=()=>Object(E.jsxs)("div",{style:{position:"absolute",height:0,overflow:"hidden"},children:[Object(E.jsx)("input",{type:"email",name:"browser_autofilled_email"}),Object(E.jsx)("input",{type:"username",name:"browser_autofilled_username"}),Object(E.jsx)("input",{type:"password",name:"browser_autofilled_password"})]});const js="InboxConnectUtils.genericInboxForm",Os={autoCapitalize:"off",autoCorrect:"off",spellCheck:!1},Cs=({onFieldChange:e,isEmailFieldDisabled:t,isPasswordFieldDisabled:s,validationMessages:n,value:a})=>Object(E.jsxs)("div",{className:"text-left m-top-4",children:[Object(E.jsx)(xs,{}),Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:js+".emailLabel"}),required:!0,error:Boolean(n.email),validationMessage:!!n.email&&Object(E.jsx)(k.a,{message:n.email}),children:Object(E.jsx)(ms.a,Object.assign({},Os,{name:"account-email","data-test-id":"account-email",autoComplete:"imapemail-no-autocomplete-"+Math.random(),disabled:t,placeholder:Object(T.a)(js+".emailPlaceholder"),defaultValue:a.email,onChange:t=>{e(t,"email")}}))}),Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:js+".passwordLabel"}),required:!0,error:Boolean(n.password),validationMessage:!!n.password&&Object(E.jsx)(k.a,{message:n.password}),children:Object(E.jsx)(ms.a,Object.assign({},Os,{type:"password",name:"account-password","data-test-id":"account-password",autoComplete:"imappass-no-autocomplete-"+Math.random(),disabled:s,placeholder:Object(T.a)(js+".passwordPlaceholder"),onChange:t=>{e(t,"password")},value:a.password}))})]});Cs.propTypes={onFieldChange:i.a.func.isRequired,isEmailFieldDisabled:i.a.bool.isRequired,isPasswordFieldDisabled:i.a.bool.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired};Cs.defaultProps={isEmailFieldDisabled:!1,isPasswordFieldDisabled:!1};var fs=Cs;const Es="InboxConnectUtils.genericInboxForm",vs=({onSubmit:e,onCancel:t,submitText:s,cancelText:n,isSubmittable:a})=>Object(E.jsxs)("div",{className:"m-top-5 justify-center",children:[Object(E.jsx)(d.a,{disabled:!a,onClick:e,type:"submit",use:"primary",children:s||Object(E.jsx)(k.a,{message:Es+".submit"})}),t&&n&&Object(E.jsx)(d.a,{use:"link",onClick:t,children:n})]});vs.propTypes={onSubmit:i.a.func.isRequired,onCancel:i.a.func,submitText:i.a.node,cancelText:i.a.string,isSubmittable:i.a.bool};var Ss=vs;const Is=({message:e})=>e?Object(E.jsx)(k.a,{message:e}):null;Is.propTypes={message:i.a.string};var ys=Is;const ws=({fieldProps:e,isExpanded:t,userFieldName:s,passwordFieldName:n,validationMessages:a,value:i})=>Object(E.jsxs)("div",{className:"text-left",children:[Object(E.jsx)(gs,Object.assign({},e,{"aria-hidden":!t,error:Boolean(a[s]),messageKeySuffix:"customUsernameLabel",name:s,validationMessage:Object(E.jsx)(ys,{message:a[s]}),value:i.get(s),wrapperProps:{className:"m-all-0"}})),Object(E.jsx)(gs,Object.assign({},e,{"aria-hidden":!t,error:Boolean(a[n]),messageKeySuffix:"passwordLabel",name:n,placeholderKeySuffix:"passwordPlaceholder",type:"password",validationMessage:Object(E.jsx)(ys,{message:a[n]}),value:i.get(n),wrapperProps:{className:"m-all-0"}}))]});ws.propTypes={fieldProps:i.a.object.isRequired,isExpanded:i.a.bool.isRequired,userFieldName:i.a.string.isRequired,passwordFieldName:i.a.string.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired};var As=ws;const Ts=({baseLangKey:e,fieldName:t,fieldProps:s,isExpanded:n,validationMessages:a,value:i})=>Object(E.jsx)(gs,Object.assign({},s,{"aria-hidden":!n,error:Boolean(a[t]),messageKeySuffix:e+".hostLabel",name:t,placeholderKeySuffix:e+".hostPlaceholder",validationMessage:Object(E.jsx)(ys,{message:a[t]}),value:i.get(t),wrapperProps:{className:"m-right-2",style:{flex:"1 auto"}}}));Ts.propTypes={baseLangKey:i.a.string.isRequired,fieldName:i.a.string.isRequired,fieldProps:i.a.object.isRequired,isExpanded:i.a.bool.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired};var ks=Ts;const _s=({baseLangKey:e,fieldName:t,fieldProps:s,isExpanded:n,validationMessages:a,value:i})=>Object(E.jsx)(gs,Object.assign({},s,{"aria-hidden":!n,error:Boolean(a[t]),messageKeySuffix:e+".portLabel",name:t,placeholderKeySuffix:e+".portPlaceholder",validationMessage:a[t]?"":null,type:"number",value:""+i.get(t),wrapperProps:{className:"m-all-0",style:{flex:"0 0 6em"}}}));_s.propTypes={baseLangKey:i.a.string.isRequired,fieldName:i.a.string.isRequired,fieldProps:i.a.object.isRequired,isExpanded:i.a.bool.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired};var Rs=_s;const Ns=["showCredentials"],Ps="InboxConnectUtils.genericInboxForm",Us=e=>{const{showCredentials:t}=e,s=Object(Qt.a)(e,Ns);return Object(E.jsxs)("div",{children:[Object(E.jsx)("h5",{className:"m-top-10 m-bottom-1",children:Object(E.jsx)(k.a,{message:Ps+".incomingServer.heading"})}),t?Object(E.jsx)(As,Object.assign({},s,{userFieldName:"customUsername",passwordFieldName:"password"})):null,Object(E.jsxs)("div",{className:"flex-row",children:[Object(E.jsx)(ks,Object.assign({},s,{baseLangKey:"incomingServer",fieldName:"imapHost"})),Object(E.jsx)(Rs,Object.assign({},s,{baseLangKey:"incomingServer",fieldName:"imapPort"}))]}),Object(E.jsx)("h5",{className:"m-top-10 m-bottom-1",children:Object(E.jsx)(k.a,{message:Ps+".outgoingServer.heading"})}),t?Object(E.jsx)(As,Object.assign({},s,{userFieldName:"smtpUsername",passwordFieldName:"smtpPassword"})):null,Object(E.jsxs)("div",{className:"flex-row",children:[Object(E.jsx)(ks,Object.assign({},s,{baseLangKey:"outgoingServer",fieldName:"smtpHost"})),Object(E.jsx)(Rs,Object.assign({},s,{baseLangKey:"outgoingServer",fieldName:"smtpPort"}))]})]})};Us.propTypes={showCredentials:i.a.bool.isRequired,fieldProps:i.a.object.isRequired,isExpanded:i.a.bool.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired};var Ds=Us,Fs=s("Jraf");const Ms="InboxConnectUtils.genericInboxForm",Ls=({fieldProps:e,handleFieldChange:t,isExpanded:s,validationMessages:n,value:a})=>Object(E.jsxs)("div",{children:[Object(E.jsx)("h5",{className:"m-top-10 m-bottom-1",children:Object(E.jsx)(k.a,{message:Ms+".security.heading"})}),a.acceptUntrustedCert&&Object(E.jsx)(Fs.a,{type:"warning",children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.genericInboxForm.security.tooltip"})}),Object(E.jsx)(gs,Object.assign({},e,{"aria-hidden":!s,error:Boolean(n.acceptUntrustedCert),checked:a.acceptUntrustedCert,style:{color:n.acceptUntrustedCert&&!a.acceptUntrustedCert&&ce.NORMAN||"inherit"},Component:p.a,messageKeySuffix:"",name:"acceptUntrustedCert",onChange:({target:{checked:e}},s)=>t({target:{value:e}},s),validationMessage:!!n.acceptUntrustedCert&&Object(E.jsx)(k.a,{message:n.acceptUntrustedCert}),value:"",children:Object(E.jsxs)(R.a,{children:[Object(E.jsx)(k.a,{message:Ms+".security.acceptUntrustedCertLabel",className:"m-right-2"}),Object(E.jsx)(j.a,{title:Object(E.jsx)(o.a,{message:"InboxConnectUtils.genericInboxForm.security.tooltip"})})]})}))]});Ls.propTypes={fieldProps:i.a.object.isRequired,handleFieldChange:i.a.func.isRequired,isExpanded:i.a.bool.isRequired,validationMessages:i.a.any.isRequired,value:i.a.any.isRequired};var qs=Ls;const Bs=e=>{const t={};if("object"==typeof e)for(const s in e)e.hasOwnProperty(s)&&e[s]&&(t[s]=e[s]);return t},Hs=["cancelText","isEmailFieldDisabled","isExpanded","disabled","isLoading","onCancel","onSubmit","serverValidationErrors","submitText","value","isAdminTemplate"],Vs="InboxConnectUtils.genericInboxForm",$s=Te.a,zs=["imapHost","imapPort","smtpHost","smtpPort","acceptUntrustedCert"],Gs=e=>Object.keys(e).some(e=>zs.includes(e)),Ks=({imapHost:e,smtpHost:t,smtpUsername:s,smtpSameCreds:n}={})=>({isImapHostValid:e?qe(e):null,isSmtpHostValid:t?qe(t):null,isSmtpUsernameValid:n?null:Object(Te.a)(s)});class Ws extends n.PureComponent{constructor(){super();this.state={didExpandAdvancedOptions:!1,isEmailValid:null,isImapHostValid:null,isSmtpHostValid:null,isSmtpUsernameValid:null,mostRecentlyValidatedEmail:""};this.getIsSubmittable=this.getIsSubmittable.bind(this);this.handleFieldChange=this.handleFieldChange.bind(this);this.validateInput=ds(500,this.validateInput.bind(this))}componentDidMount(){const{value:{email:e}={}}=this.props,t=Object.assign({isEmailValid:e?Le(e):null},Ks(this.props.value));this.setState(t)}componentDidUpdate(e){const{value:{imapHost:t,smtpHost:s}}=this.props,{value:{imapHost:n,smtpHost:a}}=e;(t!==n||s!==a)&&this.setState(Object.assign({},Ks(this.props.value)))}componentWillUnmount(){this.validateInput.cancel()}getIsSubmittable(){const{disabled:e,isLoading:t,serverValidationErrors:s,value:n}=this.props;return!e&&!t&&this.state.isEmailValid&&this.state.isImapHostValid&&this.state.isSmtpHostValid&&(n.smtpSameCreds||this.state.isSmtpUsernameValid)&&$s(n.password)&&Me(n.imapPort)&&Me(n.smtpPort)&&(!s.get("UNTRUSTED_CERTIFICATES")||!0===n.acceptUntrustedCert)}getValidationState(e,t,s){const n=e.email?Le(e.email):null;if(s){const a=!t.isEmailValid&&n,i=e.email!==t.mostRecentlyValidatedEmail&&n;(a||i)&&s({email:e.email})}return Object.assign({isEmailValid:n,mostRecentlyValidatedEmail:e.email||""},Ks(e))}validateInput(e){this.setState(t=>this.getValidationState(e,t,this.props.handleDiscover))}handleValueChange(e){const{onChange:t}=this.props;t(Object(Ot.a)(e));this.validateInput(e)}handleFieldChange({target:{value:e}},t){const{value:s}=this.props,n=s.set(t,e);this.handleValueChange(n)}render(){const e=this.props,{cancelText:t,isEmailFieldDisabled:s,isExpanded:n,disabled:a,isLoading:i,onCancel:r,onSubmit:c,serverValidationErrors:l,submitText:d,value:u,isAdminTemplate:h}=e,m=Object(Qt.a)(e,Hs),{didExpandAdvancedOptions:b,isEmailValid:g,isImapHostValid:x,isSmtpHostValid:j,isSmtpUsernameValid:O}=this.state;delete m.handleDiscover;delete m.onChange;const C=this.getIsSubmittable(),f={autoCapitalize:"off",autoComplete:"false",autoCorrect:"off",disabled:a||h,keyPrefix:Vs,onChange:this.handleFieldChange,required:!0,spellCheck:!1},v=(e,t)=>null!==e&&(e?void 0:`${Vs}.${t}`),S={email:v(g,"emailInvalid"),imapHost:v(x,"incomingServer.hostInvalid"),smtpHost:v(j,"outgoingServer.hostInvalid"),smtpUsername:v(O,"outgoingServer.usernameInvalid")},I=Bs(Object.assign({},Ne(l),S)),y=Gs(I),w=({target:{checked:e}},t)=>{let s=u.set(t,e);e||u.customUsername?e&&u.customUsername===u.email&&(s=s.set("customUsername","")):s=s.set("customUsername",u.email);this.handleValueChange(s)},A=()=>Object(E.jsx)(gs,Object.assign({},f,{"aria-hidden":!n,checked:u.smtpSameCreds,Component:p.a,messageKeySuffix:"",name:"smtpSameCreds",onChange:w,value:"",children:Object(E.jsx)(o.a,{message:Vs+".outgoingServer.customCredentials"})})),k=Object(E.jsxs)(us.a,{className:"m-top-10 text-left",disabled:n||y,onOpenChange:()=>{this.setState({didExpandAdvancedOptions:!b})},open:n||b||y,title:Object(T.a)(Vs+".advancedSettingsHeading"),children:[A(),u.smtpSameCreds?Object(E.jsx)(gs,Object.assign({},f,{"aria-hidden":!n,helpKeySuffix:"optionalField",messageKeySuffix:"customUsernameLabel",name:"customUsername",required:!1,value:u.customUsername})):null,Object(E.jsx)(Ds,{isExpanded:n,value:u,fieldProps:f,validationMessages:I,showCredentials:!u.smtpSameCreds}),Object(E.jsx)(qs,{fieldProps:f,handleFieldChange:this.handleFieldChange,isExpanded:n,validationMessages:I,value:u})]});return Object(E.jsxs)(ps.a,Object.assign({action:""},m,{onSubmit:!a&&C?c:Zt.a,children:[Object(E.jsx)(fs,{onFieldChange:this.handleFieldChange,isEmailFieldDisabled:s,isPasswordFieldDisabled:!u.smtpSameCreds,validationMessages:I,value:u}),Object(E.jsx)(ue.a,{disabled:!h,title:Object(E.jsx)(o.a,{message:Vs+".isAdminTemplate"}),children:k}),Object(E.jsx)(xs,{}),i&&Object(E.jsx)(N.a,{className:"m-top-10",grow:!0}),Object(E.jsx)(Ss,{onSubmit:c,onCancel:r,submitText:d,cancelText:t,isSubmittable:C})]}))}}Ws.propTypes={cancelText:i.a.node,disabled:i.a.bool,isEmailFieldDisabled:i.a.bool,handleDiscover:i.a.func,isLoading:i.a.bool,isExpanded:i.a.bool,onCancel:i.a.func,onChange:i.a.func.isRequired,onSubmit:i.a.func,serverValidationErrors:i.a.instanceOf(Q.Map).isRequired,submitText:i.a.node,value:i.a.object.isRequired,isAdminTemplate:i.a.bool};Ws.defaultProps={isEmailFieldDisabled:!1,isLoading:!1,isExpanded:!1,serverValidationErrors:Object(Q.Map)(),isAdminTemplate:!1};const Ys=Object(Q.Record)({acceptUntrustedCert:!1,created:null,customUsername:"",email:"",id:null,imapHost:"",imapPort:993,password:"",smtpHost:"",smtpPort:465,updated:null,smtpSameCreds:!0,smtpUsername:"",smtpPassword:"",useStaticIps:!1,settingsSource:""},"GenericInboxRecord");Ys.fromJS=e=>{if(!e||"object"!=typeof e)return e;return Ys(e)};var Xs=Ys;Object(Q.Record)({emailAddress:null,inboxType:null,isEnabled:null,hasConnectionError:null},"ConnectedAccountRecord");const Js=Object(Q.Record)({acceptUntrustedCert:!1,created:null,email:"",id:null,domain:"",password:"",exchangeUrl:"",updated:null,customUsername:""},"ExchangeInboxRecord");Js.fromJS=e=>{if(!e||"object"!=typeof e)return e;return Js(e)};var Qs=Js,Zs={gmail:Z.gmail.key,outlook365:Z.outlook365.key,imap:Z.imap.key,exchange:Z.exchange.key};const en=e=>Xs({acceptUntrustedCert:e.acceptUntrustedCert,created:e.created,customUsername:e.customUsername?e.customUsername:null,email:e.email,id:e.id,imapHost:e.domain,imapPort:0,password:e.password,smtpHost:e.exchangeUrl,smtpPort:0,updated:e.updated}),tn=e=>Qs({acceptUntrustedCert:e.acceptUntrustedCert,created:e.created,customUsername:e.customUsername,email:e.email,id:e.id,domain:e.imapHost,password:e.password,exchangeUrl:e.smtpHost,updated:e.updated}),sn=e=>{const{id:t,email_address:s,created:n,updated:a,custom_username:i,generic_inbox_settings:{imap_host_name:o,imap_port:r,smtp_host_name:c,smtp_port:l,smtp_username:d,user_accepts_untrusted_certificates:u}}=e.toJS();return Xs({acceptUntrustedCert:u,created:n,customUsername:i,email:s,id:t,imapHost:o,imapPort:r,password:"",smtpHost:c,smtpPort:l,updated:a,smtpUsername:d})},nn=e=>({emailAddress:e.email,id:e.id,serviceType:Zs.imap}),an=e=>({emailAddress:e.email,id:e.id,serviceType:Zs.exchange,exchangeUrl:e.exchangeUrl,username:e.customUsername}),on={body:"body",title:"title"},rn="InboxConnectUtils.wizard.errorCodes",cn={[on.body]:{generic:["0","500",Ae.c,Ae.n,Ae.l],[Zs.imap]:[Ae.p,Ae.a,Ae.g,Ae.j,Ae.h,Ae.i,Ae.m,Ae.o,Ae.p],[Zs.exchange]:[Ae.o,Ae.g,Ae.j,Ae.h,Ae.i,Ae.m,Ae.b,Ae.f,Ae.e,Ae.d]},[on.title]:{generic:[Ae.a,Ae.o,Ae.p],[Zs.imap]:[Ae.g,Ae.j,Ae.h,Ae.i,Ae.m],[Zs.exchange]:[]}};class ln{}const dn={[Zs.imap]:{[Ae.p]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#unauthorized-ssl-certificates-not-trusted",[Ae.a]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#unauthorized-app-password-required-for-connection",[Ae.o]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#unauthorized",[Ae.h]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#imap-settings-incorrect",[Ae.i]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#imap-settings-incorrect",[Ae.g]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#imap-authentication-error",[Ae.j]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#imap-validation-error",[Ae.m]:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/troubleshoot-imap-inbox-connection#smtp-settings-incorrect"},[Zs.exchange]:{[Ae.b]:"https://knowledge.hubspot.com/email-tracking/connect-your-inbox-to-hubspot#connect-your-exchange-account",[Ae.d]:"https://knowledge.hubspot.com/email-tracking/troubleshoot-errors-when-connecting-an-inbox-with-exchange#exchange-url-is-invalid",[Ae.f]:"https://knowledge.hubspot.com/email-tracking/troubleshoot-errors-when-connecting-an-inbox-with-exchange#unable-to-connect-due-to-exchange-version",[Ae.e]:"https://knowledge.hubspot.com/email-tracking/troubleshoot-errors-when-connecting-an-inbox-with-exchange#unable-to-connect-to-exchange-server"}},un=(e,t)=>{const s=cn[t].generic.indexOf(e)>=0;return`${rn}.${t}.generic.${s?e:"error"}`},pn=(e,t,s)=>cn[s][e].indexOf(t)>=0?`${rn}.${s}.${e}.${t}`:un(t,s),hn=(e,t)=>dn[e]&&dn[e][t]||null,mn=e=>e instanceof ln;function bn({errorCode:e,providerType:t}){const s=pn(t,e,on.title);return Object(E.jsx)(o.a,{message:s})}var gn=s("NfVS");function xn({errorCode:e,providerType:t}){const s=pn(t,e,on.body),n=hn(t,e);if(n){const e=mn(n)?{style:{display:"none"}}:{external:!0,href:n};return Object(E.jsx)(gn.a,{message:s+"_jsx",elements:{UILink:de.a},options:e})}return Object(E.jsx)(k.a,{message:s})}function jn(e){return()=>e}function On(e){return"function"==typeof e}function Cn(e){return"number"==typeof e&&!isNaN(e)}let fn=0;function En(e=""){return`${e}${fn++}`}function vn(e){return"function"==typeof Symbol?Symbol(e):En(e)}const Sn=vn("protocolType");function In(e,t){switch(t){case null:case void 0:return""+t;default:return t.constructor&&t.constructor[e]||t[e]}}function yn(e,t){switch(t){case null:return"null";case void 0:return"undefined";default:return t[e]||En()}}function wn(e,t){switch(t){case null:return"null";case void 0:return"undefined";default:return t.prototype.hasOwnProperty(e)?t.prototype[e]:En()}}function An(e,t,s){Object.defineProperty(e,t,{configurable:!1,enumerable:!1,value:s,writable:!0});return e}function Tn({args:e,name:t,fallback:s}){const n=e.indexOf(Sn),a=vn("__p_"+t),i={},o=ss(e.length,(...e)=>{const o=e[n],r=In(a,o),c=r&&i[r]||s;if(!c)throw new Error(`${t}: not implemented for type \`${o}\``);return c(...e)});o.implement=(e,t)=>{const s=yn(a,e);null==e||e[a]||An(e,a,s);i[s]=t;return t};o.implementInherited=(e,t)=>{const s=wn(a,e);null==e||e.prototype.hasOwnProperty(a)||An(e.prototype,a,s);i[s]=t;return t};return o}Tn.TYPE=Sn;const kn=jn(!0),_n=(Tn({args:[Tn.TYPE],name:"clear"}),Tn({args:[Tn.TYPE],name:"count"})),Rn=(Tn({args:[kn,Tn.TYPE],name:"concat"}),Tn({args:[Tn.TYPE],name:"entrySeq"}),Tn({args:[On,Tn.TYPE],name:"every"}),Tn({args:[On,Tn.TYPE],name:"filter"}));Tn({args:[Cn,Tn.TYPE],name:"flattenN"}),Tn({args:[On,Tn.TYPE],name:"forEach"}),Tn({args:[kn,Tn.TYPE],name:"get",fallback:(e,t)=>t[e]}),Tn({args:[kn,Tn.TYPE],name:"has"}),Tn({args:[Tn.TYPE],name:"keySeq"}),Tn({args:[Tn.TYPE],name:"keyedEquivalent"}),Tn({args:[On,Tn.TYPE],name:"map"}),Tn({args:[kn,On,Tn.TYPE],name:"reduce"}),Tn({args:[kn,kn,Tn.TYPE],name:"set"}),Tn({args:[On,Tn.TYPE],name:"some"}),Tn({args:[On,Tn.TYPE],name:"sortBy"}),Tn({args:[Tn.TYPE],name:"valueSeq"});Rn.implement(Array,(e,t)=>t.filter(e));Rn.implementInherited(Q.Iterable,(e,t)=>t.filter(e));Rn.implement(Object,(e,t)=>{const s={},n=Object.keys(t),a=n.length;for(let i=0;i<a;i++){const a=n[i],o=t[a];e(o,a,t)&&(s[a]=o)}return s});Rn.implementInherited(Q.Record,(e,t)=>t.reduce((s,n,a)=>e(n,a,t)?s.set(a,n):s,Object(Q.Map)()));var Nn=Rn;function Pn(e,t){return e?Nn(t=>!e.contains(t),t):t}var Un=rs(Pn);function Dn(e,t){const s=Q.Seq.Set(e);return Nn((e,t)=>!s.contains(t),t)}var Fn=rs(Dn);function Mn(e,t){let s=t;for(let t=0;t<e.length;t++)s=e[t](s);return s}function Ln(...e){e.forEach(ts);return Mn.bind(null,e)}_n.implement(Array,e=>e.length);_n.implementInherited(Q.Iterable,e=>e.count());_n.implement(Object,e=>Object.keys(e).length);_n.implement(String,e=>e.length);_n.implement(Number,e=>e);var qn=_n;function Bn(e){return!e||0===qn(e)}const Hn=(e,t)=>Ln(Un(e),Fn(["password"]),Bn)(t),Vn="InboxConnectUtils.wizard.imapInbox.",$n=e=>e.smtpSameCreds?"STANDARD":"SPLIT";class zn extends n.PureComponent{constructor(e){super(e);this.state={didRequestDiscovery:!1,didRequestSubmit:!1,isAdvancedSettingsPartExpanded:!1,value:Xs(),inboxErrors:Object(Q.List)(),isAdminTemplateDiscovered:!1};this.handleDiscover=this.handleDiscover.bind(this);this.handleChange=this.handleChange.bind(this);this.handleSubmit=this.handleSubmit.bind(this)}componentDidMount(){this.props.trackingClient.trackStepView(F)}componentWillUnmount(){this.clearErrors()}componentDidUpdate(){const{inbox:{id:e},inboxSettings:t}=this.props,{didRequestDiscovery:s,value:{email:n},value:a,inboxErrors:i}=this.state;if(e){this.props.trackingClient.trackStepAction(F,"submit",{subAction:"completed",subScreen:$n(a)});this.props.setEmailAddress(n);this.props.setShownStep(L);this.setState({didRequestSubmit:!1});return}0<i.size&&this.setState({didRequestSubmit:!1});const o=t&&t.get(n);if(s&&o){this.setState(Object.assign({},this.getNextStateParts(a,o),{didRequestDiscovery:!1}));this.props.trackingClient.trackStepAction(F,"autodiscovery")}}clearErrors(){this.setState({inboxErrors:this.state.inboxErrors.clear()})}clearError(e){this.setState({inboxErrors:this.state.inboxErrors.delete(e)})}addError(e){this.setState({inboxErrors:this.state.inboxErrors.push(e)})}getNextStateParts(e,t){return{isAdvancedSettingsPartExpanded:!(t&&t.imapHost&&t.imapPort&&t.smtpHost&&t.smtpPort),value:e.merge(t)}}handleDiscover({email:e}){if(!Le(e))return;const{value:t}=this.state;this.setState({didRequestDiscovery:!0,isAdminTemplateDiscovered:!1});this.props.service.discoverInboxSettings(e).then(e=>{const{value:s}=this.state,n=Hn(t,s);e&&n&&"ADMIN"===e.settingsSource&&this.setState({isAdminTemplateDiscovered:!0});const a=e||{};n&&this.setState(this.getNextStateParts(t,a));this.setState({didRequestDiscovery:Boolean(!e)})}).catch(()=>{this.props.setShownStep(U)})}handleChange({target:{value:e}}){this.setState({value:e})}handleSubmit(e){e.preventDefault();this.setState({didRequestSubmit:!0});const{service:t,trackingClient:s,setShownStep:n,setConnectedAccount:a}=this.props,{value:i}=this.state,o=()=>this.setState({isAdvancedSettingsPartExpanded:!0}),r=e=>{if(e.error){this.addError(e.error);o();return}a(nn(e));const{value:{email:t}}=this.state;this.props.setEmailAddress(t);this.props.trackingClient.trackStepAction(F,"submit",{subAction:"completed",subScreen:$n(i)});n(L)};s.trackStepAction(F,"submit",{subAction:"creating",subScreen:$n(i)});this.clearErrors();t.createImapInbox(this.state.value).then(r).catch(o).finally(()=>this.setState({didRequestSubmit:!1})).catch(e=>{setTimeout(()=>{throw e})})}render(){const{isAdvancedSettingsPartExpanded:e,didRequestDiscovery:t,didRequestSubmit:s,value:n,inboxErrors:a,isAdminTemplateDiscovered:i}=this.state,o=(e,t={})=>Object(E.jsx)(k.a,{message:`${Vn}${e}`,options:t}),r=e=>()=>this.clearError(e);return Object(E.jsx)(_.a,{justify:"center",direction:"row","data-selenium":"imap-inbox-step",children:Object(E.jsxs)(R.a,{basis:"420px",children:[Object(E.jsx)("h2",{className:"text-center",children:o("title")}),Object(E.jsx)("p",{children:Object(E.jsx)(gn.a,{message:"InboxConnectUtils.genericInboxForm.advancedSettingsHelp_jsx",elements:{UILink:de.a},options:{href:"https://knowledge.hubspot.com/articles/kcs_article/email-notifications/how-can-i-find-my-email-servers-imap-and-smtp-information",external:!0}})}),a&&a.map(e=>Object(E.jsx)(Fs.a,{className:"m-bottom-2",closeable:!0,"data-errorcode":e,onClose:r,titleText:Object(E.jsx)(bn,{providerType:Zs.imap,errorCode:e}),type:"danger",children:Object(E.jsx)(xn,{providerType:Zs.imap,errorCode:e})},e)),s?Object(E.jsx)(N.a,{className:"m-y-10",grow:!0}):Object(E.jsx)(Ws,{disabled:s,handleDiscover:this.handleDiscover,isLoading:t||s,isExpanded:e,onChange:this.handleChange,onSubmit:this.handleSubmit,serverValidationErrors:ne(a),submitText:o("button"),value:n,isAdminTemplate:i})]})})}}zn.propTypes=Object.assign({},J,{inbox:i.a.instanceOf(Xs).isRequired,inboxSettings:i.a.instanceOf(Q.Map).isRequired});zn.defaultProps={inbox:Xs(),inboxSettings:Object(Q.Map)()};var Gn=zn;const Kn="InboxConnectUtils.genericInboxForm.exchange",Wn=({validationMessages:e,exchangeUrl:t,onSuggestionClick:s})=>{if(e.smtpHost)return Object(E.jsx)(k.a,{message:e.smtpHost});if(e.exchangeUrlError){const e=$e(t);return e?Object(E.jsx)(re.a,{message:Kn+".urlAppearsToBeIncorrectSuggestion",options:{suggestedUrl:Object(E.jsx)(de.a,{onClick:()=>s(e),children:e})}}):Object(E.jsx)(k.a,{message:Kn+".urlAppearsToBeIncorrect"})}return null};Wn.propTypes={validationMessages:i.a.object.isRequired,exchangeUrl:i.a.string.isRequired,onSuggestionClick:i.a.func.isRequired};var Yn=Wn;const Xn="InboxConnectUtils.genericInboxForm",Jn={autoCapitalize:"off",autoComplete:"false",autoCorrect:"off",keyPrefix:Xn,spellCheck:!1},Qn=({isRequired:e,validationMessages:t,value:s,disabled:n,handleFieldChange:a})=>{const{exchangeUrl:i}=s,r=Yn({validationMessages:t,exchangeUrl:i,onSuggestionClick:e=>a(Object(Ot.a)(e),"exchangeUrl")});return Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:"InboxConnectUtils.genericInboxForm.exchange.urlLabel"}),required:e,error:Boolean(r),description:Object(E.jsx)(o.a,{message:"InboxConnectUtils.genericInboxForm.exchange.supportedProducts"}),validationMessage:r,children:Object(E.jsx)(ms.a,Object.assign({},Jn,{value:i,name:"exchangeUrl",disabled:n,placeholder:Object(T.a)(Xn+".exchange.urlPlaceholder"),defaultValue:s.customUsername,onChange:e=>a(e,"exchangeUrl")}))})};Qn.propTypes={fieldProps:i.a.object.isRequired,isRequired:i.a.bool.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired,disabled:i.a.bool.isRequired,handleFieldChange:i.a.func.isRequired};Qn.defaultProps={isRequired:!1};var Zn=Qn;const ea="InboxConnectUtils.genericInboxForm",ta={autoCapitalize:"off",autoCorrect:"off",spellCheck:!1},sa=({onFieldChange:e,isEmailFieldDisabled:t,isUsernameFieldDisabled:s,isUsernameFieldHidden:a,isPasswordFieldDisabled:i,validationMessages:r,value:c})=>Object(E.jsxs)(n.Fragment,{children:[Object(E.jsx)(xs,{}),Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:ea+".emailLabel"}),required:!0,error:Boolean(r.email),validationMessage:!!r.email&&Object(E.jsx)(k.a,{message:r.email}),children:Object(E.jsx)(ms.a,Object.assign({},ta,{autoComplete:"exchangeemail-no-autocomplete-"+Math.random(),name:"email",disabled:t,placeholder:Object(T.a)(ea+".emailPlaceholder"),defaultValue:c.email,onChange:t=>{e(t,"email")}}))}),!a&&Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:ea+".customUsernameLabel"}),required:!1,error:Boolean(r.customUsername),validationMessage:!!r.customUsername&&Object(E.jsx)(k.a,{message:r.customUsername}),children:Object(E.jsx)(ms.a,Object.assign({},ta,{autoComplete:"exchangeuser-no-autocomplete-"+Math.random(),name:"customUsername",disabled:s,placeholder:Object(T.a)(ea+".exchange.usernamePlaceholder"),defaultValue:c.customUsername,onChange:t=>e(t,"customUsername")}))}),Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:ea+".passwordLabel"}),required:!0,error:Boolean(r.password),validationMessage:!!r.password&&Object(E.jsx)(k.a,{message:r.password}),children:Object(E.jsx)(ms.a,Object.assign({},ta,{autoComplete:"exchangepass-no-autocomplete-"+Math.random(),type:"password",name:"password",disabled:i,placeholder:Object(T.a)(ea+".passwordPlaceholder"),onChange:t=>{e(t,"password")},value:c.password}))})]});sa.propTypes={onFieldChange:i.a.func.isRequired,isEmailFieldDisabled:i.a.bool.isRequired,isUsernameFieldDisabled:i.a.bool.isRequired,isUsernameFieldHidden:i.a.bool.isRequired,isPasswordFieldDisabled:i.a.bool.isRequired,validationMessages:i.a.object.isRequired,value:i.a.any.isRequired};sa.defaultProps={isEmailFieldDisabled:!1,isUsernameFieldDisabled:!1,isUsernameFieldHidden:!1,isPasswordFieldDisabled:!1};var na=sa;const aa="InboxConnectUtils.genericInboxForm",ia=Te.a;class oa extends n.PureComponent{constructor(e){super(e);this.state=Object.assign({},this.getValidationState(this.props.value));this.getIsSubmittable=this.getIsSubmittable.bind(this);this.handleFieldChange=this.handleFieldChange.bind(this);this.validateInput=ds(500,this.validateInput.bind(this))}componentWillUnmount(){this.validateInput.cancel()}componentDidUpdate(e){this.props.value.email===e.value.email&&this.props.value.password===e.value.password&&this.props.value.exchangeUrl===e.value.exchangeUrl||this.setState(Object.assign({},this.getValidationState(this.props.value)))}getIsSubmittable(){const{disabled:e,isLoading:t,serverValidationErrors:s,value:n}=this.props;return!e&&!t&&this.state.isEmailValid&&(!this.props.didAutoDiscoveryFail&&this.state.isExchangeUrlEmpty||this.state.isExchangeUrlValid)&&ia(n.password)&&(!s.get("UNTRUSTED_CERTIFICATES")||!0===n.acceptUntrustedCert)}getValidationState(e){return{isEmailValid:e.email?Le(e.email):null,isExchangeUrlEmpty:!(e.exchangeUrl&&e.exchangeUrl.length>0),isExchangeUrlValid:e.exchangeUrl?Be(e.exchangeUrl):null,mostRecentlyValidatedEmail:e.email||""}}validateInput(e){this.setState(this.getValidationState(e))}handleFieldChange({target:{value:e}},t){const{onChange:s,value:n}=this.props,a=n.set(t,e);s(Object(Ot.a)(a));this.validateInput(a)}render(){const{cancelText:e,isEmailFieldDisabled:t,didExpandAdvancedSettings:s,didAutoDiscoveryFail:n,disabled:a,isLoading:i,handleExpand:o,onCancel:r,onSubmit:c,serverValidationErrors:l,submitText:d,value:u}=this.props,{isEmailValid:p,isExchangeUrlValid:h}=this.state,m=s||n,b=this.getIsSubmittable(),g={email:null!==p&&(p?void 0:aa+".emailInvalid"),exchangeUrlError:!1===h},x=Bs(Object.assign({},Ne(l),g));return Object(E.jsxs)(ps.a,{action:"",className:"text-left m-top-4",autoComplete:"off",onSubmit:!a&&b?c:Zt.a,children:[Object(E.jsx)(na,{onFieldChange:this.handleFieldChange,isEmailFieldDisabled:t,isUsernameFieldHidden:!m,validationMessages:x,value:u}),m&&Object(E.jsx)(Zn,{isRequired:n,validationMessages:x,value:u,disabled:a,handleFieldChange:this.handleFieldChange}),Object(E.jsx)(xs,{}),!m&&Object(E.jsx)(de.a,{className:"m-top-5 display-block text-center",style:{color:"grey"},onClick:()=>{o()},children:Object(E.jsx)(k.a,{message:aa+".exchange.showOptionalFields"})}),i&&Object(E.jsx)(N.a,{className:"m-top-10",grow:!0}),Object(E.jsx)(Ss,{onSubmit:c,onCancel:r,submitText:d,cancelText:e,isSubmittable:b})]})}}oa.propTypes={cancelText:i.a.node,disabled:i.a.bool,isEmailFieldDisabled:i.a.bool,isLoading:i.a.bool,didAutoDiscoveryFail:i.a.bool.isRequired,didExpandAdvancedSettings:i.a.bool.isRequired,handleExpand:i.a.func.isRequired,onCancel:i.a.func,onChange:i.a.func.isRequired,onSubmit:i.a.func,serverValidationErrors:i.a.instanceOf(Q.Map).isRequired,submitText:i.a.node,value:i.a.object.isRequired};oa.defaultProps={isEmailFieldDisabled:!1,isLoading:!1,serverValidationErrors:Object(Q.Map)()};const ra="InboxConnectUtils.wizard.imapInbox.";class ca extends n.PureComponent{constructor(e){super(e);this.state={didRequestSubmit:!1,didExpandAdvancedSettings:!1,didAutoDiscoveryFail:!1,value:Qs(),inboxErrors:Object(Q.List)()};this.handleChange=this.handleChange.bind(this);this.handleSubmit=this.handleSubmit.bind(this);this.openAdvancedSettings=this.openAdvancedSettings.bind(this)}componentDidMount(){this.props.trackingClient.trackStepView(M)}componentDidUpdate(){const{inbox:{id:e},inboxSettings:t}=this.props,{value:{email:s},value:n,inboxErrors:a}=this.state;if(e){this.props.trackingClient.trackStepAction(M,"submit",{subAction:"completed"});this.props.setEmailAddress(s);this.props.setShownStep(L);this.setState({didRequestSubmit:!1});return}0<a.size&&this.setState({didRequestSubmit:!1});const i=t&&t.get(s);if(i){this.setState(Object.assign({},this.getNextStateParts(n,i),{didRequestDiscovery:!1}));this.props.trackingClient.trackStepAction(M,"autodiscovery")}}componentWillUnmount(){this.clearErrors()}clearErrors(){this.setState({inboxErrors:this.state.inboxErrors.clear()})}clearError(e){this.setState({inboxErrors:this.state.inboxErrors.delete(e)})}addError(e){this.setState({inboxErrors:this.state.inboxErrors.push(e)})}getNextStateParts(e,t){return{didAutoDiscoveryFail:!(t&&t.exchangeUrl&&t.domain),value:e.merge(t)}}handleChange({target:{value:e}}){this.setState({value:e})}handleSubmit(e){e.preventDefault();const{trackingClient:t,service:s,setShownStep:n,setConnectedAccount:a}=this.props,{value:i}=this.state;t.trackStepAction(M,"submit",{subAction:"creating"});this.clearErrors();const o=e=>{const{error:t}=e;if(t){this.addError(t);t===Ae.b&&this.setState({didAutoDiscoveryFail:!0});return}a(an(e));const{value:{email:s}}=this.state;this.props.setEmailAddress(s);this.props.trackingClient.trackStepAction(M,"submit",{subAction:"completed"});n(L)};this.setState({didRequestSubmit:!0});s.createExchangeInbox(i).then(o).catch(()=>this.setState({didAutoDiscoveryFail:!0})).finally(()=>this.setState({didRequestSubmit:!1})).catch(e=>{setTimeout(()=>{throw e})})}openAdvancedSettings(){this.setState({didExpandAdvancedSettings:!0})}render(){const{didAutoDiscoveryFail:e,didExpandAdvancedSettings:t,didRequestSubmit:s,value:n,inboxErrors:a}=this.state,i=e=>()=>this.clearError(e);return Object(E.jsx)(_.a,{justify:"center",direction:"row","data-selenium":"exchange-inbox-step",children:Object(E.jsxs)(R.a,{className:"text-center",basis:"420px",children:[Object(E.jsx)("h2",{children:Object(E.jsx)(k.a,{message:ra+"titleExchange"})}),Object(E.jsx)(gn.a,{message:"InboxConnectUtils.genericInboxForm.advancedSettingsHelp_jsx",elements:{UILink:de.a},options:{href:"https://knowledge.hubspot.com/email-tracking/connect-your-inbox-to-hubspot#connect-your-exchange-account",external:!0}}),a&&a.map(e=>Object(E.jsx)(Fs.a,{className:"m-bottom-2 text-left",closeable:!0,"data-errorcode":e,onClose:i,titleText:Object(E.jsx)(bn,{providerType:Zs.exchange,errorCode:e}),type:"danger",children:Object(E.jsx)(xn,{errorCode:e,providerType:Zs.exchange})},e)),s?Object(E.jsx)(N.a,{className:"m-y-10",grow:!0}):Object(E.jsx)(oa,{disabled:s,isLoading:s,didExpandAdvancedSettings:t,didAutoDiscoveryFail:e,handleExpand:this.openAdvancedSettings,onChange:this.handleChange,onSubmit:this.handleSubmit,serverValidationErrors:ne(a),submitText:Object(E.jsx)(k.a,{message:ra+"button"}),value:n})]})})}}ca.propTypes=Object.assign({},J,{inbox:i.a.instanceOf(Qs).isRequired,inboxSettings:i.a.instanceOf(Q.Map).isRequired});ca.defaultProps={inbox:Qs(),inboxSettings:Object(Q.Map)()};var la=ca;const da="InboxConnectUtils.wizard.finish";class ua extends n.Component{static ActionButton({use:e="primary",onClick:t,message:s}){return Object(E.jsx)(d.a,{className:"m-top-2",use:e,onClick:t,children:Object(E.jsx)(k.a,{message:`${da}.${s}`})})}static ActionBar({children:e}){return Object(E.jsx)(_.a,{justify:"center",direction:"row",align:"center",wrap:"wrap",children:e})}constructor(e){super(e);this.handleInstallClicked=this.handleInstallClicked.bind(this);this.handleCancelClicked=this.handleCancelClicked.bind(this);this.handleDoneClicked=this.handleDoneClicked.bind(this)}componentDidMount(){this.props.trackingClient.trackStepView(B,this.props.selectedClient)}handleInstallClicked(){const{portalId:e,onWizardDone:t,selectedClient:s}=this.props;window.open(Oe(e,s),"_blank");this.trackFinishStepAction("click-install-cta");t()}handleCancelClicked(){this.trackFinishStepAction("click-cancel");this.props.onWizardDone()}handleDoneClicked(){this.trackFinishStepAction("click-done");this.props.onWizardDone()}trackFinishStepAction(e){this.props.trackingClient.trackStepAction(B,e,{})}renderTitle(){const{emailAddress:e}=this.props,t=()=>Object(E.jsx)(o.a,{message:da+".title"});return e?(()=>Object(E.jsx)(k.a,{message:da+".nowConnected",options:{emailAddress:e}}))():t()}renderExtensionInstall(){const{portalId:e,selectedClient:t}=this.props,{ActionBar:s,ActionButton:n}=ua;return Object(E.jsxs)("div",{children:[Object(E.jsx)("div",{className:"m-bottom-1",children:Object(E.jsx)("b",{children:Object(E.jsx)(o.a,{message:da+".install.title"})})}),Object(E.jsx)("div",{className:"m-bottom-8",children:Object(E.jsx)("p",{children:Object(E.jsx)(re.a,{message:da+".install.description",options:{link:Object(E.jsx)(de.a,{href:Oe(e,t),onClick:()=>this.trackFinishStepAction("click-install-link"),external:!0,children:Object(E.jsx)(o.a,{message:da+".install.downloadExtensionLink"})})}})})}),Object(E.jsxs)(s,{children:[Object(E.jsx)(n,{message:"downloadLinkButton",onClick:this.handleInstallClicked}),Object(E.jsx)(n,{use:"secondary",message:"cancelButton",onClick:this.handleCancelClicked})]})]})}renderStandardFinish(){const{ActionBar:e,ActionButton:t}=ua;return Object(E.jsx)(e,{children:Object(E.jsx)(t,{message:"button",onClick:this.handleDoneClicked})})}render(){const{showExtensionInstall:e}=this.props;return Object(E.jsxs)("div",{className:"text-center center-block",style:{maxWidth:"420px"},"data-selenium":"finish-step",children:[Object(E.jsx)(m.a,{name:"successfully-connected-email",className:"m-bottom-5",style:{height:"100px"}}),Object(E.jsx)("h4",{className:"m-bottom-8",children:this.renderTitle()}),e?this.renderExtensionInstall():this.renderStandardFinish()]})}}ua.propTypes=J;var pa=s("XBoB"),ha=s("LkYt"),ma=s("PQdV"),ba=s("Pf7D");const ga=pt()(le.a).attrs({responsive:!1}).withConfig({displayName:"ConnectProviderButton__ConnectProviderButtonImage",componentId:"sc-1l8uxs0-0"})(["height:50px;"]),xa=pt()(ha.a).withConfig({displayName:"ConnectProviderButton__ConnectProviderButtonTitle",componentId:"sc-1l8uxs0-1"})([""]),ja=pt()(pa.a).withConfig({displayName:"ConnectProviderButton",componentId:"sc-1l8uxs0-2"})(["border-color:",";border-radius:",";border-width:",";border-style:solid;padding:12px 24px;flex:1 0 0px;display:flex;flex-direction:column;","{flex:0 0 auto;align-self:center;}","{flex:1 0 auto;margin-top:12px;display:flex;flex-direction:column;justify-content:center;}&:hover{box-shadow:0 0 0 1px ",",0 0 12px 0 ",";}"],ba.r,ma.n,ma.k,ga,xa,ba.s,ba.s),Oa=pt.a.div.withConfig({displayName:"ConnectButtonWrapper__ConnectProviderButtonWrapper",componentId:"sc-1ca829e-0"})(["display:flex;flex-direction:row;justify-content:space-around;align-items:stretch;width:100%;","{&:not(:first-child){margin-left:12px;}}@media only screen and (max-width:600px){flex-direction:column;align-items:stretch;","{margin:0 0 0 12px;font-size:16px;}","{margin-left:0 !important;flex:1 0 auto;flex-direction:row;&:not(:first-child){margin-top:12px;}}","{width:32px;height:auto;}}"],ja,xa,ja,ga),Ca="InboxConnectUtils.wizard.chooseProvider.";class fa extends n.Component{constructor(e){super(e);this.handleNotSureWhichToChooseLinkClick=this.handleNotSureWhichToChooseLinkClick.bind(this)}componentDidMount(){this.props.trackingClient.trackStepView(U)}handleClientClick(e){this.props.trackingClient.trackStepAction(U,e);const{setSelectedClient:t,setShownStep:s,isAllowCustomEmailInput:n}=this.props;t(e);return s(n?D:H)}handleNotSureWhichToChooseLinkClick(){this.props.trackingClient.trackStepAction(U,"not sure what to choose click")}renderClientButton(e,t){const{allowedProviders:s}=this.props;if(s&&!s.includes(e))return null;const n=()=>this.handleClientClick(e);return Object(E.jsxs)(ja,{onClick:n,"data-selenium":"choose-provider-step-btn-"+e,children:[t?Object(E.jsx)(pe.a,{name:t,style:{height:40}}):Object(E.jsx)(ga,{src:ot.a,style:{height:40}}),Object(E.jsx)(xa,{style:{whiteSpace:"normal"},children:Object(E.jsx)(o.a,{message:`${Ca}${e}`})})]},e)}render(){const{gmail:e,imap:t,outlook365:s,exchange:n}=Z,{selectedClient:a,isAutodetectFlow:i}=this.props;return Object(E.jsx)(_.a,{className:"text-center",justify:"center","data-selenium":"choose-provider-step",children:Object(E.jsxs)(R.a,{basis:"650px",children:[!a&&i&&Object(E.jsx)(Fs.a,{titleText:Object(T.a)(Ca+"errorTitle"),type:"info",className:"m-bottom-8 m-all-auto",style:{width:"50%"},children:Object(E.jsx)(k.a,{message:Ca+"errorMsg"})}),Object(E.jsx)("h2",{children:Object(E.jsx)(k.a,{message:Ca+"title"})}),Object(E.jsx)(Oa,{className:"m-y-12",justify:"center",children:[e,s,n,t].map(e=>this.renderClientButton(e.key,e.logo))}),Object(E.jsx)(de.a,{className:"display-inline-block center-block",external:!0,href:"https://knowledge.hubspot.com/articles/kcs_article/email-tracking/connect-your-inbox-to-hubspot",onClick:this.handleNotSureWhichToChooseLinkClick,target:"_blank",use:"blue",children:Object(E.jsx)(k.a,{message:Ca+"link"})})]})})}}fa.propTypes=J;var Ea=s("3Shb");const va="conversations-admin",Sa=e=>{const{scopes:t,roles:s}=e&&e.user||{};return{scopes:t||[],roles:s||[]}},Ia=e=>Sa(e).scopes.indexOf(va)>=0,ya="InboxConnectUtils.adminEmail",wa=/<[^>]+>/g,Aa=(e,t)=>{const s=Ue(e),n=e=>Object(T.a)(`${ya}.${e}`),a=Object(T.a)(s.key,Object.assign({},s.options,t)).replace(wa,""),i=s.options.link||"",o=`${n("greeting")}\n\n${n("preface")}\n\n${e}\n\n${a}\n${i}\n\n${n("postface")}`,r=n("subject");return`mailto:?subject=${encodeURIComponent(r)}&body=${encodeURIComponent(o)}`};var Ta=s("AuX0"),ka=s("xV13"),_a=s("RmcN");const Ra="InboxConnectUtils.removeAllConnectionsPrompt";class Na extends n.Component{render(){const{onConfirm:e,onReject:t,emailAddress:s,usersEmails:n}=this.props;return Object(E.jsxs)(r.a,{use:"danger",children:[Object(E.jsxs)(b.a,{children:[Object(E.jsx)(c.a,{onClick:t}),Object(E.jsx)(g.a,{children:Object(E.jsx)(o.a,{message:Ra+".heading",options:{emailAddress:s}})})]}),Object(E.jsxs)(l.a,{children:[Object(E.jsx)("p",{children:Object(E.jsx)(o.a,{message:Ra+".otherAccountsPreface"})}),Object(E.jsx)(h.a,{styled:!0,children:n.map(e=>Object(E.jsx)("span",{children:e},e))}),Object(E.jsx)("p",{children:Object(E.jsx)(o.a,{message:Ra+".howToConnect",options:{emailAddress:s}})})]}),Object(E.jsxs)(Ta.a,{children:[Object(E.jsx)(d.a,{use:"danger",onClick:e,children:Object(E.jsx)(o.a,{message:Ra+".disconnectUsersButton"})}),Object(E.jsx)(d.a,{use:"tertiary-light",onClick:t,children:Object(E.jsx)(o.a,{message:Ra+".cancelButton"})}),Object(E.jsx)(u.a,{use:"help",children:Object(E.jsx)(o.a,{message:Ra+".disconnectionNotice"})})]})]})}}Na.propTypes=Object.assign({},ka.a,{emailAddress:i.a.string.isRequired,usersEmails:i.a.arrayOf(i.a.string).isRequired});var Pa=Object(_a.a)(Na),Ua=s("LZPL"),Da=s.n(Ua),Fa=s("WRZ8"),Ma=s("xX1V");const La=(e,t,s={},...n)=>{!Object(Ma.a)(t)&&s._defaultMessage&&Object(Ma.a)(s._defaultMessage)&&(t=s._defaultMessage);if(Object(Ma.a)(t))t=Object(E.jsx)(k.a,{message:t,options:s});else if(!Da.a.deployed()){console.warn("Alert key not translated: ",t);s._defaultMessage&&console.warn("Alert default key not translated: ",s._defaultMessage)}Fa.a.addAlert(Object.assign({message:t,type:e},...n))},qa=(Fa.a.addAlert,(...e)=>La("warning",...e)),Ba=(...e)=>La("success",...e),Ha="InboxConnectUtils.wizard.failure",Va=({connectError:e})=>{if(!e)return null;const t="string"==typeof e?e:JSON.stringify(e);return Object(E.jsx)("p",{children:t})};class $a extends n.PureComponent{constructor(e){super(e);this.state={fixFunction:null,showErrorLog:!1}}componentDidMount(){const{trackingClient:e,connectError:t}=this.props;e.trackStepView(q,""+t,Pe(t)?"":"UNHANDLED");this.checkAutoRepairability()}checkAutoRepairability(){const{service:e,connectError:t,trackingClient:s}=this.props,n=Object(Ae.r)(t);n&&e.removeAllConnectionsForEmail&&e.getUserInfo&&e.getUserInfo().then(t=>{if(Ia(t)){const{emailAddress:t,usersEmails:a}=n,i=()=>{Pa({emailAddress:t,usersEmails:a}).then(()=>e.removeAllConnectionsForEmail(t)).then(()=>Ba(Ha+".repairSucceeded")).then(()=>this.props.setShownStep(U)).catch(e=>{const t=e&&(e.errorMessage||e.statusText);t&&qa(Ha+".repairFailed",{errorMessage:t})});s.trackStepAction(q,"repair-shared-personal-disconnect")};this.setState({fixFunction:i})}})}renderDefaultRepairSteps(){const{setShownStep:e,trackingClient:t,connectError:s,emailAddress:n}=this.props,{showErrorLog:a}=this.state,i=()=>t.trackStepAction(q,"share");return Object(E.jsxs)("div",{"data-selenium":"failure-step",children:[Object(E.jsxs)("div",{className:"text-left",children:[Object(E.jsx)("h5",{children:Object(E.jsx)(o.a,{message:Ha+".whatYouCanDo.title"})}),Object(E.jsxs)(h.a,{ordered:!0,styled:!0,children:[Object(E.jsx)(de.a,{href:Aa(s,{emailAddress:n}),onClick:i,children:Object(E.jsx)(o.a,{message:Ha+".whatYouCanDo.steps.shareMessage"})}),Object(E.jsx)(o.a,{message:Ha+".whatYouCanDo.steps.reconnect"})]})]}),Object(E.jsxs)(Ea.a,{justify:"center",children:[Object(E.jsx)(d.a,{name:"reconnect",use:"primary",onClick:()=>e(U),children:Object(E.jsx)(o.a,{message:Ha+".reconnectButton"})}),a?null:Object(E.jsx)(d.a,{name:"showLog",onClick:()=>this.setState({showErrorLog:!0}),children:Object(E.jsx)(o.a,{message:Ha+".showLog"})})]})]})}renderRepairButton(e){return Object(E.jsx)(d.a,{use:"primary",onClick:e,children:Object(E.jsx)(o.a,{message:Ha+".repairButton"})})}render(){const{fixFunction:e,showErrorLog:t}=this.state,{connectError:s,emailAddress:n}=this.props,{key:a,options:i}=Ue(s),r=Object.assign({},i,{emailAddress:n}),c=e?this.renderRepairButton(e):this.renderDefaultRepairSteps(),l=Object(E.jsx)(o.a,{message:Ha+".title"});return Object(E.jsxs)("div",{className:"text-center",children:[Object(E.jsxs)(Fs.a,{titleText:l,type:"danger",className:"text-left",children:[Object(E.jsx)("p",{children:Object(E.jsx)(k.a,{message:a,options:r})}),t&&Object(E.jsx)(Va,{connectError:s})]}),Object(E.jsx)("div",{className:"m-all-4",children:c})]})}}$a.propTypes=J;function za(e,t){if(void 0===t){t=e;e=void 0}return new Promise(s=>{setTimeout(()=>{s(e)},t)})}var Ga=za;const Ka="LIMIT_EXCEEDED",Wa="FAILED",Ya="OK",Xa="CONNECTED",Ja=2e3,Qa=2e3,Za=30,ei="InboxConnectUtils.wizard.testMessage.";var ti=[{message:ei+"establishingConnection",operation:(e,t)=>Promise.resolve(t).then(e=>Ga(e,Ja))},{message:ei+"sendingTestEmail",operation:(e,t)=>Promise.resolve(e.createTestEmail(t)).then(e=>Ga(e,Ja))},{message:ei+"verifyingConnection",operation:(e,t)=>{if(t.latest_status===Wa)throw t.latest_error_type;let s=0;const n=()=>{if(s++===Za)throw Ka;return Ga(Qa).then(()=>e.queryTestEmail(t.email_guid)).then(e=>{switch(e.latest_status){case Wa:throw e.latest_error_type;case Ya:return Xa;default:return n()}})};return n()}}];class si extends n.PureComponent{constructor(e){super(e);this.state={message:""}}componentDidMount(){this.props.trackingClient.trackStepView(L);this.startTest()}startTest(){const{emailAddress:e,service:t,setShownStep:s,setConnectError:n}=this.props,a=()=>s(V),i=e=>this.getInbox().then(t=>{t.error_type||t.error_message?n({error_type:t.error_type,error_message:t.error_message}):n(e&&e.message)}).catch(()=>n(e&&e.message)).finally(()=>s(q));ti.reduce((e,s)=>e.then(e=>{this.setState({message:s.message});return s.operation(t,e)}),Promise.resolve(e)).then(a).catch(i)}getInbox(){const{emailAddress:e,service:t}=this.props;return t.getFacsimileInboxByEmail(e)}render(){const{message:e}=this.state;return Object(E.jsx)("div",{className:"justify-center align-center",style:{height:"100%"},children:Object(E.jsxs)("div",{className:"text-center","data-selenium":"test-message-step",children:[Object(E.jsx)(N.a,{grow:!0,minHeight:100}),Object(E.jsx)("p",{children:e&&Object(E.jsx)(o.a,{message:e})})]})})}}si.propTypes=J;var ni=si,ai=s("mEYk"),ii=s.n(ai);const oi=e=>{ii.a.captureException(e)};class ri extends n.PureComponent{constructor(e){super(e);this.setInboxAutomation=()=>{const{emailAddress:e,setShownStep:t,selectedAutomation:s,service:n,trackingClient:a}=this.props;if("boolean"==typeof s){const i=()=>{a.trackStepAction(V,"automation-set",{value:s.toString()});t(B)},o=e=>{oi(e);t(B)};if(n.setEnableAutomation){n.setEnableAutomation(e,s).then(i).catch(o);return}}t(B)};this.state={message:"InboxConnectUtils.wizard.postSetup.configuringSettings"}}componentDidMount(){this.props.trackingClient.trackStepView(V);this.setInboxAutomation()}render(){const{message:e}=this.state;return Object(E.jsx)("div",{className:"justify-center align-center",style:{height:"100%"},children:Object(E.jsxs)("div",{className:"text-center","data-selenium":"post-connect-step",children:[Object(E.jsx)(N.a,{grow:!0,minHeight:100}),Object(E.jsx)("p",{children:Object(E.jsx)(o.a,{message:e})})]})})}}ri.propTypes=J;var ci=ri,li=s("pbrb");class di extends n.Component{constructor(...e){super(...e);this.state={email:"",emailValid:!1,showChooseProviderButton:!1,nextButtonLoading:!1,nextButtonDisabled:!0};this.displayProviderButton=()=>{this.setState({showChooseProviderButton:!0,nextButtonLoading:!1})};this.onClickNext=()=>{this.props.trackingClient.trackStepAction($,"clicked next button");this.setState({nextButtonLoading:!0});this.props.setEmailAddress(this.state.email);this.detectClient()};this.detectClient=()=>{const{service:e,setSelectedClient:t,setShownStep:s}=this.props;e.getProviderByEmailAddress(this.state.email).then(e=>{const n=ie(e.get("name"));if(null!==n){t(n);this.setState({nextButtonLoading:!1});s(z)}else this.displayProviderButton()}).catch(()=>{this.displayProviderButton()})};this.onClickChooseProvider=()=>{this.props.trackingClient.trackStepAction($,"clicked choose email provider button");const{setShownStep:e}=this.props;e(U)};this.handleEmailChange=({target:{value:e}})=>{this.setState({email:e,showChooseProviderButton:!1,nextButtonDisabled:!0});const t=Boolean(Le(e));this.setState({emailValid:t});t&&this.setState({nextButtonDisabled:!1})};this.renderButton=()=>Object(E.jsx)("div",{className:"m-top-5",children:this.state.showChooseProviderButton?Object(E.jsx)(d.a,{use:"primary",onClick:this.onClickChooseProvider,children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.emailInput.chooseEmailProvider"})}):Object(E.jsx)(li.a,{use:"primary",loading:this.state.nextButtonLoading,disabled:this.state.nextButtonDisabled,onClick:this.onClickNext,children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.emailInput.next"})})});this.handleKeyDownForEmailInput=({keyCode:e})=>{13===e&&this.onClickNext()};this.renderEmailInput=()=>Object(E.jsx)(hs.a,{label:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.emailInput.emailLabel"}),required:!0,style:{textAlign:"left"},children:Object(E.jsx)(ms.a,{name:"email",defaultValue:this.state.email,placeholder:Object(T.a)("InboxConnectUtils.wizard.emailInput.emailPlaceholder"),onChange:this.handleEmailChange,onKeyDown:this.handleKeyDownForEmailInput})})}componentDidMount(){this.props.trackingClient.trackStepView($)}render(){return Object(E.jsx)(_.a,{direction:"row",justify:"center","data-selenium":"email-input-step",children:Object(E.jsxs)(R.a,{basis:"420px",className:"text-center",children:[Object(E.jsx)(g.a,{children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.emailInput.title"})}),this.renderEmailInput(),this.state.showChooseProviderButton&&Object(E.jsx)("div",{className:"m-top-5",children:Object(E.jsx)("b",{children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.emailInput.cannotIdentifyEmail"})})}),this.renderButton()]})})}}di.propTypes=J;var ui=s("EIJv");const pi={gmail:{company:"Google",name:"Gmail"},outlook:{company:"Microsoft",name:"Outlook"},outlook365:{company:"Microsoft",name:"Outlook 365"},exchange:{company:"Microsoft",name:"Exchange"},imap:{company:"Imap",name:"Imap"}},hi=pt.a.div.withConfig({displayName:"CustomEmailDetectStep__RoundedBorder",componentId:"sc-1vvl28e-0"})(["border-radius:25px;border:2px solid "," !important;width:fit-content;margin:auto;box-sizing:border-box;padding:3px;padding-left:25px;padding-right:25px;display:flex;align-items:center;justify-content:center;"],ce.FLINT),mi=pt()(ui.a).withConfig({displayName:"CustomEmailDetectStep__StyledEmail",componentId:"sc-1vvl28e-1"})(["display:inline;padding-left:5px;width:fit-content !important;font-weight:600;"]);class bi extends n.Component{constructor(...e){super(...e);this.onClickConnectToProvider=()=>{this.props.trackingClient.trackStepAction(z,"clicked connect client");const{setShownStep:e}=this.props;e(D)};this.onClickChooseProviderLink=()=>{this.props.trackingClient.trackStepAction(z,"clicked choose provider link");this.props.setShownStep(U)};this.renderChooseDifferentProviderLink=()=>Object(E.jsx)("div",{className:"m-top-5",children:Object(E.jsx)(de.a,{onClick:this.onClickChooseProviderLink,children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.customEmailDetect.chooseProviderMyself"})})});this.renderConnectButton=()=>{const{selectedClient:e}=this.props,{name:t=e}=pi[e];return Object(E.jsx)("div",{className:"m-top-5",children:Object(E.jsx)(d.a,{use:"primary",onClick:this.onClickConnectToProvider,children:Object(E.jsx)(k.a,{message:"InboxConnectUtils.wizard.customEmailDetect.connectToProvider",options:{provider:t}})})})};this.renderRecommendation=()=>{const{selectedClient:e}=this.props,{company:t=e,name:s=e}=pi[e];return Object(E.jsx)("div",{className:"m-top-5",children:Object(E.jsx)("b",{children:Object(E.jsx)(k.a,{message:"InboxConnectUtils.wizard.customEmailDetect.recommendForProvider",options:{company:t,providerName:s}})})})};this.renderEmail=()=>{const{emailAddress:e}=this.props;return Object(E.jsxs)(hi,{children:[Object(E.jsx)(x.a,{name:"contacts",size:"small",color:ce.EERIE}),Object(E.jsx)(mi,{"data-test":"email-input",children:e})]})}}componentDidMount(){this.props.trackingClient.trackStepView(z)}render(){return Object(E.jsx)(_.a,{direction:"row",justify:"center","data-selenium":"custom-email-detect-step",children:Object(E.jsxs)(R.a,{basis:"420px",className:"text-center",children:[Object(E.jsx)(g.a,{children:Object(E.jsx)(o.a,{message:"InboxConnectUtils.wizard.customEmailDetect.title"})}),this.renderEmail(),this.renderRecommendation(),this.renderConnectButton(),this.renderChooseDifferentProviderLink()]})})}}bi.propTypes=J;var gi={DETECT_PROVIDER_STEP:{component:oe},CHOOSE_PROVIDER_STEP:{component:fa},OPT_INTO_AUTOMATION_STEP:{component:Jt},EMAIL_INPUT_STEP:{component:di},CUSTOM_EMAIL_DETECT_STEP:{component:bi},CONNECT_INBOX_STEP:{component:Wt},IMAP_INBOX_STEP:{component:Gn},EXCHANGE_INBOX_STEP:{component:la},TEST_MESSAGE_STEP:{component:ni},FAILURE_STEP:{component:$a},POST_SETUP_STEP:{component:ci},FINISH_STEP:{component:ua}};const xi=["where_screen","where_subscreen","what_event_class"],ji="inbox-connect-utils",Oi=(e,t,s,n)=>Object.assign({},s,{what_event:t,where_app_override:ji,what_extra_json:Object.assign({},n,{host:e||""})}),Ci=(e,t={},s={})=>{const{where_screen:n,where_subscreen:a}=t,i=Object(Qt.a)(t,xi);return Object.assign({host:e,screen:n,subscreen:a},i,s)},fi=e=>{const t=(t,s={},n={})=>e.track(Oi(e.getAppName(),t,s,n));let s=e.getTracker();s&&(s=s.clone({properties:{namespace:ji}}));const n=(t,n={},a={})=>{s.track(t,Ci(e.getAppName(),n,a))},a=s?n:t;return{trackStepView:(e,t="",s="")=>a("wizard-view",{where_screen:e,where_subscreen:t,what_event_class:"VIEW",what_value_str:s},{action:"view"}),trackStepAction:(e,t,{subAction:s="",subScreen:n="",value:i=""}={})=>a("wizard-interaction",{where_screen:e,where_subscreen:n,what_value_str:i,what_event_class:"INTERACTION"},{action:t,subAction:s}),trackInboxConnected:()=>a("inbox-connected",{what_event_class:"ACTIVATION"})}},Ei=(e,t,s,n)=>t?s&&n?H:D:e?P:U,vi=e=>{const t=JSON.parse(atob(e)),{error:s,payload:n,passthrough:a}=t;if(s){const{message:e,emailAddress:t}=n||{};return{connectError:e||"0",shownStep:q,emailAddress:t,selectedAutomation:a.selectedAutomation}}const{emailAddress:i,serviceType:o}=n;return{emailAddress:i,connectedAccount:n,shownStep:L,selectedClient:o,selectedAutomation:a.selectedAutomation}},Si=(e,{allowAutoDetectFlow:t,provider:s,showFinishStep:n,showInboxAutomationStep:a,serviceHasAIAutomation:i})=>{let o=e;o===P&&(o=Ei(t,!!s,a,i));o===H&&(a&&i||(o=D));o===U&&s&&(o=a&&i?H:D);o!==B||n||(o=G);return o};class Ii extends n.Component{constructor(e){super(e);this.trackingClient=null;this.returnedFromOauth=!1;const{emailAddress:t,provider:s,oauthOptions:n,allowAutoDetectFlow:a,allowCustomEmailInput:i,service:o}=this.props;let r=Si(a?P:U,Object.assign({},e,{serviceHasAIAutomation:!!o.setEnableAutomation}));i&&!s&&(r=H);this.state={emailAddress:t||"",selectedClient:s||"",shownStep:r,startStep:r,connectError:null,connectedAccount:null};if(n&&n.connectAction){this.returnedFromOauth=!0;this.state=Object.assign({},this.state,vi(n.connectAction))}this.trackingClient=fi(o);this.handleOnWizardDone=this.handleOnWizardDone.bind(this);this.handleUpdateEmail=this.handleUpdateEmail.bind(this);this.handleUpdateError=this.handleUpdateError.bind(this)}componentDidMount(){this.returnedFromOauth||this.trackingClient.trackStepView("PROVISION_STEP",K)}componentDidUpdate(e){const t=this.props.provider,s=e.provider;s!==t&&this.setState({selectedClient:s});this.props.emailAddress&&this.state.emailAddress!==this.props.emailAddress&&this.setState({emailAddress:this.props.emailAddress})}componentWillUnmount(){const{startStep:e}=this.state,{provider:t}=this.props;this.setState({selectedClient:t||"",shownStep:e})}handleOnWizardDone(){const{connectedAccount:e}=this.state,{onDone:t}=this.props;this.trackingClient.trackInboxConnected();t(e)}handleUpdateEmail(e){this.setState({emailAddress:e})}handleUpdateError(e){this.setState({connectError:e})}render(){const{allowAutoDetectFlow:e,allowCustomEmailInput:t,allowedProviders:s,inboxType:n,oauthOptions:a,provider:i,restrictProvider:o,onDone:r,service:c,showExtensionInstall:l,showFinishStep:d,inboxCreateContext:u,onStateChange:p,onCancel:h,showInboxAutomationStep:m,whatToExpectDescription:b}=this.props,{connectError:g,emailAddress:x,selectedClient:j,shownStep:O,connectedAccount:C,selectedAutomation:f}=this.state,v=gi[O].component,S=t=>{const s=Si(t,{allowAutoDetectFlow:e,provider:i,restrictProvider:o,showFinishStep:d,showInboxAutomationStep:m,serviceHasAIAutomation:!!c.setEnableAutomation});if(s===G){this.trackingClient.trackInboxConnected();r(C)}else{p&&p({cancelable:s!==L});this.setState({shownStep:s})}},I=e=>this.setState({selectedClient:e}),y=e=>this.setState({selectedAutomation:e}),w=e=>{this.setState({connectedAccount:e})};return Object(E.jsx)(v,{allowedProviders:s,connectError:g,setConnectError:this.handleUpdateError,emailAddress:x||"",setEmailAddress:this.handleUpdateEmail,isAutodetectFlow:e,isAllowCustomEmailInput:t,inboxType:n,oauthOptions:a,portalId:c.getPortalId(),restrictProvider:!0===(o&&!!i),selectedClient:j,service:c,setConnectedAccount:w,onWizardDone:this.handleOnWizardDone,setSelectedClient:I,setShownStep:S,trackingClient:this.trackingClient,showExtensionInstall:l,inboxCreateContext:u,onStateChange:p,onCancel:h,setSelectedAutomation:y,selectedAutomation:f,showInboxAutomationStep:m,whatToExpectDescription:b})}}Ii.defaultProps={allowedProviders:[Zs.gmail,Zs.imap,Zs.outlook365,Zs.exchange],inboxType:W.STANDARD,showExtensionInstall:!0,showFinishStep:!0,showInboxAutomationStep:!1,allowCustomEmailInput:!0};Ii.propTypes={service:X.isRequired,onDone:i.a.func.isRequired,onStateChange:i.a.func,inboxCreateContext:i.a.object,inboxType:i.a.oneOf(Y(W)),allowAutoDetectFlow:i.a.bool,allowCustomEmailInput:i.a.bool,allowedProviders:i.a.arrayOf(i.a.oneOf(Y(Zs))),emailAddress:i.a.string,oauthOptions:i.a.object,provider:i.a.string,restrictProvider:i.a.bool,showExtensionInstall:i.a.bool.isRequired,showFinishStep:i.a.bool.isRequired,onCancel:i.a.func,showInboxAutomationStep:i.a.bool,whatToExpectDescription:i.a.node};var yi=s("PJYd"),wi=s.n(yi),Ai=s("4e8t"),Ti=s.n(Ai),ki=s("ZVbf"),_i=s("LN55"),Ri=s("BfN3");const Ni=(e=>{const t=Object(_i.onResponse)(t=>Object(Ri.setIf)("object"==typeof t.data,"data",Object(Q.fromJS)(t.data,e))(t));return Object(ki.createStack)(_i.jsonResponse,t)})();var Pi=Ti()(Object(ki.createStack)(wi.a,Ni));const Ui="connectedaccounts/v1/feature",Di=(e,t)=>e.post(`${Ui}/CRM_EMAIL_INTEGRATION/account/${t}?state=ENABLED`),Fi="email-parser/v1/setting",Mi=(e,t,s,n)=>e.post(`${Fi}?portalId=${t}&emailEnabled=${n}&inboxEmail=${s}`),Li=(e,t,s)=>e.get(`${Fi}?portalId=${t}&inboxEmail=${s}`),qi=Object(Q.Record)({latest_status:null,latest_error_type:null,email_guid:null},"TestMessageCreateResponse"),Bi=Object(Q.Record)({latest_status:null,latest_error_type:null},"TestMessageQueryResponse"),Hi="22712",Vi=(e,t)=>`facsimile/v1/test/app/${e}/email/${t}`,$i=e=>"facsimile/v1/test/email/"+e,zi=(e,t)=>e.post(Vi(Hi,t)).then(qi),Gi=(e,t)=>e.get($i(t)).then(Bi),Ki=Object(Q.Record)({imapHost:"",imapPort:993,smtpHost:"",smtpPort:465,useStaticIps:!1,acceptUntrustedCert:!1,settingsSource:""},"InboxSettingsRecord");Ki.fromJS=e=>{if(!e||"object"!=typeof e)return e;return Ki(e)};var Wi=Ki;const Yi="InboxConnectUtils.mailIntegration",Xi=(e,t)=>Di(e,t).catch(()=>{qa(Yi+".syncError")}),Ji="facsimile/v1/inboxes",Qi=(e,t)=>e.put(Ji+"/generic/custom",{type:"PUT",timeout:6e4,data:t}),Zi=(e,t)=>e.get(`${Ji}/generic-settings/discover?email=${t}`).then(e=>{const t=Bs({imapHost:e.getIn(["imap","host"]),imapPort:e.getIn(["imap","port"]),smtpHost:e.getIn(["smtp","host"]),smtpPort:e.getIn(["smtp","port"])});t.useStaticIps=e.get("use_static_ips");t.acceptUntrustedCert=e.get("user_accepts_untrusted_certificates");t.settingsSource=e.get("settings_source");return Wi(t)}).catch(()=>Wi()),eo=e=>{const t={login_info:{email:e.email,password:e.password},settings:{custom_username:e.customUsername!==e.email?e.customUsername:null,username_strategy:e.customUsername?"CUSTOM":"EMAIL",imap_host_name:e.imapHost,imap_port:e.imapPort,smtp_host_name:e.smtpHost,smtp_port:e.smtpPort,user_accepts_untrusted_certificates:e.acceptUntrustedCert}};e.smtpSameCreds||(t.login_info_smtp={email:e.smtpUsername,password:e.smtpPassword});return t},to=e=>{if(e&&e.status>=500)return{error:"500"};const t=e&&e.data&&JSON.parse(e.data)||{},{message:s}=t;return{error:(s||e.status||"0").toString()}},so=(e,t,s)=>{let n;const a=t=>Xi(e,t.email),i=e=>{n=s.mergeWith((e,t)=>t||e,e);return n};return Qi(e,eo(s)).then(sn).then(i).then(a).then(()=>n).catch(to)},no=(e,t)=>e.put(Ji+"/exchange/create",{type:"PUT",timeout:6e4,data:t}),ao=(e,{email:t,password:s,customUsername:n})=>e.put(Ji+"/exchange/autodiscover",{data:{email:t,password:s,customUsername:n},query:{username:n}}),io=(e,t,s)=>{let n;const a=en(s),i=t=>Xi(e,t.email),o=e=>{n=s.mergeWith((e,t)=>t||e,e);return n};return(s.exchangeUrl?no(e,eo(a)):ao(e,s)).then(sn).then(tn).then(o).then(i).then(()=>n).catch(to)},oo="connectedaccounts/v1",ro="facsimile/v1",co=ro+"/inboxes",lo=e=>`${ro}/provider/domain/${e}`,uo=()=>ro+"/provider",po=e=>`${ro}/provider/email/${e}`,ho=e=>`${oo}/emails/${encodeURIComponent(e)}/all`;Object(Q.Record)({"@type":null,id:null,email_address:null,inbox_type:null,created:null,updated:null,user_id:null,error_message:null,portal_id:null,hub_spot_user_id:null,blacklisted_date:null,error_type:null,generic_inbox_settings:null,blacklisted:null,bucket:null,shared:null,must_get_hub_spot_user_id:null,oauth_scope_set:null,oauth_service_type:null},"FacsimileInboxRecord");const mo=(e,t)=>{const s=t.toLowerCase();return t=>t&&t.portal_id===e&&t.email_address&&t.email_address.toLowerCase()===s},bo=(e,t)=>s=>s.get("inboxes").toJS().find(mo(e,t));var go=s("GgP/"),xo=s.n(go);const jo=["apiClient","appName","portalId"];class Oo{constructor(e){jo.forEach(t=>{if(!e[t])throw new Error(t+" required in DefaultService config")});const{apiClient:t,appName:s,portalId:n,track:a,tracker:i,gates:o}=e;if(!a&&!i)throw new Error("Need at least a hublytics track function or tracker object");this.apiClient=t;this.appName=s;this.portalId=n;this.trackFunction=a;this.tracker=i;this.gates=o}getAppName(){return this.appName}getTracker(){return this.tracker}getPortalId(){return this.portalId}getGates(){return this.gates?Promise.resolve(this.gates):xo()().then(({portal:{enabled_gates:e}})=>e)}enableConnectedAccount(e){return Di(this.apiClient,e)}createTestEmail(e){return zi(this.apiClient,e)}queryTestEmail(e){return Gi(this.apiClient,e)}getProviderNameByDomain(e){return this.apiClient.get(lo(e)).then(e=>e.get("name"))}getProvider(){return this.apiClient.get(uo(),{timeout:5e3})}getProviderByEmailAddress(e){return this.apiClient.get(po(e),{timeout:5e3})}getFacsimileInboxByEmail(e){return this.apiClient.get(co).then(bo(this.portalId,e))}discoverInboxSettings(e){return Zi(this.apiClient,e)}createImapInbox(e){return so(this.apiClient,this.portalId,e)}createExchangeInbox(e){return io(this.apiClient,this.portalId,e)}track(e){this.trackFunction&&this.trackFunction(e)}removeAllConnectionsForEmail(e){return this.apiClient.delete(ho(e))}getUserInfo(){return xo()()}setEnableAutomation(e,t){return Mi(this.apiClient,this.portalId,e,t)}getEnableAutomation(e){return Li(this.apiClient,this.portalId,e)}}const Co=({appName:e,bindPortalIdToClient:t,portalId:s,track:n,tracker:a,apiClient:i=Pi,gates:o})=>new Oo({appName:e,portalId:s,track:n,tracker:a,apiClient:t?A(i,s):i,gates:o});class fo extends n.Component{render(){const{allowAutoDetectFlow:e,allowedProviders:t,apiClient:s,appName:n,emailAddress:a,fullScreen:i,hublyticsTracker:o,oauthOptions:d,portalId:u,provider:p,restrictProvider:h,showWizard:m,usageTracker:g}=this.props,x=i?"fullscreen":"conversational",{onDone:j}=this.props,O=()=>j(!1),C=A(s,u),f=Co({apiClient:C,appName:n,portalId:u,track:(...e)=>o.track(...e),tracker:g});return Object(E.jsxs)("div",{children:[this.props.instantiateAlerts&&Object(E.jsx)(I.a,{}),m&&Object(E.jsxs)(r.a,{width:720,use:x,children:[Object(E.jsx)(b.a,{children:Object(E.jsx)(c.a,{onClick:O})}),Object(E.jsx)(l.a,{children:Object(E.jsx)(Ii,{service:f,onDone:e=>j(!!e),allowAutoDetectFlow:e,allowedProviders:t,emailAddress:a,oauthOptions:d,provider:p,restrictProvider:h})})]})]})}}fo.propTypes={apiClient:i.a.shape({get:i.a.func,post:i.a.func,put:i.a.func,del:i.a.func}).isRequired,appName:i.a.string.isRequired,hublyticsTracker:i.a.shape({track:i.a.func}),onDone:i.a.func.isRequired,portalId:i.a.oneOfType([i.a.string,i.a.number]).isRequired,showWizard:i.a.bool.isRequired,usageTracker:i.a.shape({clone:i.a.func}),allowAutoDetectFlow:i.a.bool,allowedProviders:i.a.arrayOf(i.a.string),emailAddress:i.a.string,fullScreen:i.a.bool,instantiateAlerts:i.a.bool,oauthOptions:i.a.object,provider:i.a.string,restrictProvider:i.a.bool};s("9NgN");var Eo=s("uLb4"),vo=s.n(Eo),So=s("1thV");const Io=({onClose:e,portalId:t,connectCalendar:s})=>{const{tracker:a,trackUserInteraction:i}=Object(So.c)(),o=Object(n.useMemo)(()=>Co({appName:"getting-started-ui",portalId:t,tracker:a.clone({events:vo.a})}),[t,a]);return Object(E.jsxs)(r.a,{use:"conversational",width:700,children:[Object(E.jsx)(b.a,{children:Object(E.jsx)(c.a,{onClick:()=>{e();i("close task modal","connect inbox modal")}})}),Object(E.jsx)(l.a,{children:Object(E.jsx)(Ii,{allowAutoDetectFlow:!0,inboxCreateContext:{connectCalendar:s},inboxType:W.STANDARD,onDone:e,service:o,showFinishStep:!1})})]})};Io.propTypes={connectCalendar:i.a.bool,onClose:i.a.func.isRequired,portalId:i.a.number.isRequired};var yo=Io,wo=s("FExm");s.d(t,"WEBPACK_3_FORCE_MODULE_IMPORT",(function(){return To}));const Ao=({onClose:e})=>{const t=Object(wo.a)(),[s,a]=Object(n.useState)(!1),[i,o]=Object(n.useState)(!1),r=e=>{e&&a(!0);o(!0)};return i?Object(E.jsx)(yo,{connectCalendar:s,onClose:e,portalId:t}):Object(E.jsx)(S,{onClose:e,onSelectConnectInbox:r})};t.default=Ao;const To=1},uLb4:function(e,t){e.exports={"wizard-view":{name:"wizard-view",class:"view",properties:{action:"string",what_value_str:{type:"string",isOptional:!0},wordpress_plugin:{type:"string",isOptional:!0},host:{type:"string",isOptional:!0},screen:{type:"string",isOptional:!0},subscreen:{type:"string",isOptional:!0}},namespace:"inbox-connect-utils"},"wizard-interaction":{name:"wizard-interaction",class:"interaction",properties:{action:"string",subAction:{type:"string",isOptional:!0},what_value_str:{type:"string",isOptional:!0},wordpress_plugin:{type:"string",isOptional:!0},host:{type:"string",isOptional:!0},screen:{type:"string",isOptional:!0},subscreen:{type:"string",isOptional:!0}},namespace:"inbox-connect-utils"},"inbox-connected":{name:"Inbox Connected",class:"activation",properties:{host:{type:"string"},wordpress_plugin:{type:"string",isOptional:!0},screen:{type:"string",isOptional:!0},subscreen:{type:"string",isOptional:!0}},namespace:"inbox-connect-utils"}}},uivf:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n),i=s("oxA8"),o=s("xV13"),r=s("DqRu"),c=s("qS8i"),l=s("BiPx"),d=s("AuX0"),u=s("6A2w"),p=s("iJaT"),h=s("LDwU"),m=s("9NgN");const b=()=>({type:m.a,payload:{message:h.q}});var g=s("CE3l"),x=s("QgEn");const j="InboxConnectUtils.optIn",O=e=>{const{onClick:t,onConfirm:s,onReject:n,langKey:a}=e,o=(e,t={})=>Object(x.jsx)(i.a,{message:`${j}.${a}.${e}`,options:t}),h=e=>{e.preventDefault();"function"==typeof t&&t();s()},m=()=>n(b());return Object(x.jsxs)(p.a,{width:600,children:[Object(x.jsxs)(u.a,{children:[Object(x.jsx)(l.a,{onClick:m}),Object(x.jsx)(g.a,{children:o("title")})]}),Object(x.jsx)(c.a,{children:Object(x.jsx)("div",{style:{height:"400px",overflowY:"scroll"},children:o("body")})}),Object(x.jsxs)(d.a,{children:[Object(x.jsx)(r.a,{use:"primary",onClick:h,className:"m-x-1",children:o("confirmButton")}),Object(x.jsx)(r.a,{onClick:m,className:"m-x-1",children:o("cancelButton")})]})]})};O.propTypes=Object.assign({},o.a,{langKey:a.a.string.isRequired});t.a=O},xV13:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n);const i={onConfirm:a.a.func.isRequired,onReject:a.a.func.isRequired};t.a=i},y1B9:function(e,t,s){"use strict";var n=s("VfuR"),a=s.n(n),i=s("xV13"),o=s("uivf"),r=s("QgEn");const c=e=>Object(r.jsx)(o.a,Object.assign({},e,{langKey:"outlook"}));c.propTypes=Object.assign({},i.a,{allowRequestGroup:a.a.string.isRequired});t.a=c},zUz2:function(e,t){e.exports="//static.hsappstatic.net/InboxConnectUtils/static-4.6103/images/unknown-email.svg"}}]);
//# sourceMappingURL=//static.hsappstatic.net/setup-guide-ui/static-1.32015/ConnectInboxModal.js.map